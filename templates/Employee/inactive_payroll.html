<!DOCTYPE html>
<html>
<head>
    <!-- Basic Page Info -->
    <meta charset="utf-8">
    <title>HRMS</title>
    <link rel="icon" href="/static/logo/apple-touch-icon.png" type="image/x-icon">

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <!-- Site favicon -->
    <!-- <link rel="apple-touch-icon" sizes="180x180" href="static/index/vendors/images/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="static/index/vendors/images/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="static/index/vendors/images/favicon-16x16.png"> -->

    <!-- Mobile Specific Metas -->
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <!-- Google Font -->

      <link rel="apple-touch-icon" sizes="180x180" href="static/index/vendors/images/apple-touch-icon.png">
      <link rel="icon" type="image/png" sizes="32x32" href="static/index/vendors/images/favicon-32x32.png">
      <link rel="icon" type="image/png" sizes="16x16" href="static/index/vendors/images/favicon-16x16.png">
  
      <!-- Mobile Specific Metas -->
      <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
      <!-- Google Font -->
      <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
      <!-- CSS -->
      <link rel="stylesheet" type="text/css" href="static/index/vendors/styles/core.css">
      <link rel="stylesheet" type="text/css" href="static/index/vendors/styles/icon-font.min.css">
      <link rel="stylesheet" type="text/css" href="static/index/src/plugins/jquery-steps/jquery.steps.css">
      <link rel="stylesheet" type="text/css" href="static/index/vendors/styles/style.css">
  
  
      <!-- Global site tag (gtag.js) - Google Analytics -->
      <script async src="https://www.googletagmanager.com/gtag/js?id=UA-119386393-1"></script>
      <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-119386393-1');
    </script>
    <script>
       
        flatpickr("[data-behavior='flatpickr']", {
            allowInput: true,
            dateFormat: "Y-m-d"
        });
    </script>

<style>
    .ps-table-common.br {
        border: 1px solid #000000;
        margin-top: 2%;
        }

        .ps-table-common {
        width: 100%;
        height: 100%;
        table-layout: fixed;
        border-collapse: collapse;
    }

    .ps-table-common.br > tbody > tr > td:first-child {
        border-right: 1px solid #000000;
    }

    .ps-table-common td{
        height: 100%;
    }
    /* .h-100 {
        height: 100%!important;
    } */
    .half {
        width: 50%;
        padding: 5px 0 5px 10px;
        display: inline-block;
        text-transform: capitalize;
        font-size: 13px;
    }
    .ps-table-common tr.Header {
        font-weight: 600;
        border-bottom: 1px solid #000000;
    }
    .half-75 {
        width: 75%;
        padding: 5px 0 5px 10px;
        display: inline-block;
        text-transform: capitalize;
        font-size: 14px;
    }
    .half:last-child, .half-2:last-child, .half-25:last-child, .half-75:last-child {
        padding: 5px 10px 5px 0;
        width: 80%;
        font-size: 13px;
    }
    .half-25 {
        width: 25%;
        padding: 5px 0 5px 10px;
        display: inline-block;
        text-transform: capitalize;
    }
    .text-right {
        text-align: right!important;
    }
    .ps-table-common tr.footer {
        font-weight: 600;
        border-top: 1px solid #000000;
    }
    .semibold {
        font-weight: 600 !important;
    }
    .ps-wrapper-footer {
        width: 100%;
        padding-left: 20px;
        padding-right: 20px;
        padding-bottom: 10px;
    }
    hr.ps-hr {
        margin: 10px 0;
        border-color: #000000;
    }


</style>

</head>
<body>

    <div class="header">
        <div class="header-left">
            <div class="menu-icon dw dw-menu"></div>
            
        </div>
        <div class="header-right">
           
            <!-- <div class="user-notification">
                <div class="dropdown">
                    <a class="dropdown-toggle no-arrow" href="#" role="button" data-toggle="dropdown">
                        <i class="icon-copy dw dw-notification"></i>
                        <span class="badge notification-active"></span>
                    </a>
                    <div class="dropdown-menu dropdown-menu-right">
                        <div class="notification-list mx-h-350 customscroll">
                            <ul>
                                <li>
                                    <a href="#">
                                        <img src="static/index/vendors/images/img.jpg" alt="">
                                        <h3>John Doe</h3>
                                        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed...</p>
                                    </a>
                                </li>
                                <li>
                                    <a href="#">
                                        <img src="static/index/vendors/images/photo1.jpg" alt="">
                                        <h3>Lea R. Frith</h3>
                                        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed...</p>
                                    </a>
                                </li>
                                <li>
                                    <a href="#">
                                        <img src="static/index/vendors/images/photo2.jpg" alt="">
                                        <h3>Erik L. Richards</h3>
                                        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed...</p>
                                    </a>
                                </li>
                                <li>
                                    <a href="#">
                                        <img src="static/index/vendors/images/photo3.jpg" alt="">
                                        <h3>John Doe</h3>
                                        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed...</p>
                                    </a>
                                </li>
                                <li>
                                    <a href="#">
                                        <img src="static/index/vendors/images/photo4.jpg" alt="">
                                        <h3>Renee I. Hansen</h3>
                                        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed...</p>
                                    </a>
                                </li>
                                <li>
                                    <a href="#">
                                        <img src="static/index/vendors/images/img.jpg" alt="">
                                        <h3>Vicki M. Coleman</h3>
                                        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed...</p>
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div> -->
            <div class="user-info-dropdown">
                <div class="dropdown">
                    <a class="dropdown-toggle" href="#" role="button" data-toggle="dropdown">
                        <span class="user-icon">
                            {% if k.image %}
                            <img src="{{ k.image.url }}" alt="" style="width: 100%; height:100% ">
                            {% else %}
                            <img src="/static/logo/userlogo.png" id="photo" style="width: 100%; height:100% ">
                            {% endif %} 
                         </span>
                        <span class="user-name">{{request.user.username}}</span>
                    </a>
                    <div class="dropdown-menu dropdown-menu-right dropdown-menu-icon-list">
                        <a class="dropdown-item" href="{% url 'inactive_personalinfo' %}"><i class="dw dw-user1"></i> Profile</a>
                        <!-- <a class="dropdown-item" href="javascript:;" data-toggle="right-sidebar"><i class="dw dw-settings2"></i> Setting</a> -->
                        <!-- <a class="dropdown-item" href="{% url 'help_page' %}"><i class="dw dw-help"></i> Help</a> -->
                        <a class="dropdown-item" href="{% url 'logout' %}"><i class="dw dw-logout"></i> Logout</a>
                    </div>
                </div>
            </div>
            
        </div>
    </div>

    <div class="right-sidebar">
        <div class="sidebar-title">
            <h3 class="weight-600 font-16 text-blue">
                 Settings
                <!--<span class="btn-block font-weight-400 font-12">User Interface Settings</span>-->
            </h3>
            <div class="close-sidebar" data-toggle="right-sidebar-close">
                <i class="icon-copy ion-close-round"></i>
            </div>
        </div>

        <div class="right-sidebar-body customscroll">
            <div class="right-sidebar-body-content">
                <h4 class="weight-600 font-18 pb-10" ><a href="{% url 'depart1' %}">Department</a> </h4>
                <h4 class="weight-600 font-18 pb-10"><a href="{% url 'desig1' %}">Designation</a></h4>
                <h4 class="weight-600 font-18 pb-10"><a href="{% url 'subdepartment' %}">Sub Department</a></h4>
            </div>
        </div>
    </div>

    <div class="left-side-bar">
          
        <div class="brand-logo mt-3">
       <a href="{% url 'inactive_payroll' %}">
        {% if request.user.company_type %}
        {% if request.user.company_type.inverse_logo %}
        <img src="{{ request.user.company_type.inverse_logo.url }}" style="width: 100%; height: 100%;">
        {% else %}
        <img src="/static/logo/deskapp-logo-white.svg" alt="" class="light-logo">
        {% endif %}
        {% else %}
        <img src="/static/logo/deskapp-logo-white.svg" alt="" class="light-logo">
        {% endif %}
         </a>
			<!-- <a href="index.html">  -->

				 <!-- <img src="{{ data.logo.url }}" style="width: 90% ;height: 90%; margin-left: 10px ;margin-top: -2cccccpx" > -->
            <!-- {% if data.logo %}
              <img src="{{ data.logo.url }}" style="width: 99.5% ;height: 100%; margin-left: 1px ;margin-top: -12px" >
            {% else %}
              <img src="media/default_image.png" id="photo" style="width: 90% ;height: 90%; margin-left: 10px ;margin-top: -2cccccpx" >
		    {% endif %} -->
			<!-- </a> -->
			<div class="close-sidebar" data-toggle="left-sidebar-close"> 
			   <i class="ion-close-round"></i>
			</div>
		</div><br>
       
       
        <div class="menu-block customscroll">
            <div class="sidebar-menu">
                <ul id="accordion-menu">
                    
                 
                   
                    <li class="btn-primary active" style="background-color:black">
                        <a href="{% url 'inactive_overview' %}" class="dropdown-toggle no-arrow">
                            <span class="micon dw dw-building" ></span><span class="mtext" ><b>Company Profile</b></span>
                        </a>
                    </li>
                    <li>
                        <a href="{% url 'inactive_personalinfo' %}" class="dropdown-toggle no-arrow">
                            <span class="micon dw dw-user1" ></span><span class="mtext" ><b>My Profile</b></span>
                        </a>
                    </li>
                   
                   
                </ul>
            </div>
        </div>
    </div>
    
    <div class="main-container">
        <div class="card-box height-100-p overflow-hidden">
                    <!-- <br><h4 class="text-blue h4" style="padding-left:30px">COMPANY PROFILE</h4> -->
            <ul class="nav nav-tabs customtab" role="tablist">
                

             <li class="nav-item">
                 <a class="nav-link "  href="{% url 'inactive_personalinfo' %}" >Personal</a>
             </li>
             <li class="nav-item">
                 <a class="nav-link"  href="{% url 'inactive_work' %}" >Work</a>
             </li>
             <li class="nav-item">
                 <a class="nav-link"  href="{% url 'inactive_team' %}" >Team</a>
             </li>
             <li class="nav-item">
                 <a class="nav-link"  href="{% url 'inactive_education' %}" >Education</a>
             </li>
             <li class="nav-item">
                 <a class="nav-link"  href="{% url 'inactive_family' %}" >Family</a>
             </li>
             <li class="nav-item">
                 <a class="nav-link" href="{% url 'inactive_document' %}" >Documents</a>
             </li>
             <li class="nav-item">
                 <a class="nav-link " href="{% url 'inactive_workweek' %}" >Work Week</a>
             </li>
             <li class="nav-item">
                 <a class="nav-link active" href="{% url 'inactive_payroll' %}" >Payroll</a>
             </li>
             <li class="nav-item">
                <a class="nav-link" href="{% url 'inactive_e_exit' %}" >E-Exit</a>
            </li>
          

        </ul>
                     
            <!-- <div class="min-height-100px"> -->
                <!-- <div class="tab height-100-p"> -->
                    <!-- <br><h4 class="text-blue h4" style="padding-left:30px">Payroll</h4> -->
                    <ul class="nav nav-tabs customtab" role="tablist">
                        
                        <li class="nav-item">
                            <a class="nav-link active" href="{% url 'inactive_payroll' %}">Pay Slip</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link  " href="{% url 'inactive_salarystructure' %}">Salary Structure</a>
                        </li>
                        
                        <li class="nav-item">
                            <a class="nav-link " href="{% url 'inactive_bankaccount' %}">Bank Account</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="{% url 'inactive_reimbursements' %}">Reimbursements</a>
                        </li>
                    </ul>
                    
            <!-- </div>  -->
            <div class="pd-50 card-box"> 
                <div class="pd-20 clearfix">
                    <form action="{% url 'inactive_payroll' %}" method="get" id="search-form">

                        <div class="row">

							<!-- <label class="col-sm-12 col-md-2 col-form-label">Month</label> -->
							<div class="col-md-3">
                                <div class="input-group">
                                    <div class="form-group" id="monthpicker-payslip">
                                    <input id="monthPicker" name="monthselect" class="form-control month-picker payslip" type="text" style="margin-top: 4%;margin-left: 10%;"    />
                                
                                    </div>                                
                                    <span onclick="var input = this.previousElementSibling; input.value = ''; input.focus(); " style="position: absolute;margin-left: 90%;margin-top: 7%;cursor:pointer" id="cross-payslip">
                                    <a href="{% url 'inactive_payroll' %}" style="color: grey;">x</a>
							        </span>
                                </div>
                            </div>
                            
						</div>
                    </form>
                </div>  
                
                {% for payreg in payregister %}

                <div class="row">
                    <div class="col-12">
                        <div class="payslip-box" style="border-style: solid; width: 80%;
                        margin: 0 auto;
                        padding: 20px;">

                        <table class="ps-table-common">
                            <tbody>
                                <tr>
                                    <td>
                                        
                                        <div class="ps-logo-wrapper" style="width: 65%;">
                                        
                                            <img src="{{ c.logo.url }}" class="ps-company-logo img-fluid">
                                        
                                        </div>
                                        
                                    </td>
                                    <td width="60%" class="for_mobile-res-td-width min-wd-320">
                                        <div class="col-xs-6">
                                            <div class="ps-company-title-wrapper text-center">
                                                <h2 class="ps-main-title" style="font-size: 30px;
                                                font-weight: 600;
                                                line-height: 1;
                                                margin: 10px 0;">{{ c.registeredcompanyname }}</h2>
                                                <p class="m-0 ps-main-address">
                                                    {% for i in regaddress%}
                                                    {{i.regofficeaddress}}, {{i.regdistrict}}, {{i.regstate}}, {{i.regcountry}} - {{i.regpincode}}
                                                    {% endfor %}
                                                </p>
                                                    
                                                </p>
                                            </div>
                                        </div>
                                    </td>
                                    <td width="20%"></td>
                                </tr>
                            </tbody>
                        </table>


                        <h5 class="text-center ps-time-period" style="font-weight: 400;margin-top: 1%;margin-top: 1%;">Payslip for the Month of {{payreg.createddate|date:"F,Y"}}</h5>
                        
                        <table class="ps-table-common br">
                            <tbody>
                                <tr>
                                    <td class="mobile-res-wd" width="50%">
                                        <div class="d-flex h-100"><div class="half">Name:</div><div class="half">{{payreg.user_id.username}}</div></div>
                                    </td>
                                    <td class="mobile-res-wd" width="50%">
                                        <div class="d-flex h-100"><div class="half">Employee ID:</div><div class="half">{{payreg.user_id.empid}}</div></div>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="mobile-res-wd" width="50%">
                                        <div class="d-flex h-100"><div class="half">Designation:</div><div class="half">{{payreg.user_id.designation.name}}</div></div>
                                    </td>
                                    <td class="mobile-res-wd" width="50%">
                                        <div class="d-flex h-100"><div class="half">Bank Name:</div><div class="half" id="bank_name">
                                            {% for detail in bank_details%}
                                            {{detail.bank_name}}
                                            {% endfor %}
                                        </div></div>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="mobile-res-wd" width="50%">
                                        <div class="d-flex h-100"><div class="half">Department:</div><div class="half">{{payreg.user_id.department.name}}</div></div>
                                    </td>
                                    <td class="mobile-res-wd" width="50%">
                                        <div class="d-flex h-100"><div class="half">Bank Account No.:</div><div class="half">
                                            {% for detail in bank_details%}
                                            {{detail.account_number}}
                                            {% endfor %}
                                        </div></div>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="mobile-res-wd" width="50%">
                                        <div class="d-flex h-100"><div class="half">Location:</div><div class="half">{{payreg.user_id.wrklcn.location}}</div></div>
                                    </td>
                                    <td class="mobile-res-wd" width="50%">
                                        <div class="d-flex h-100"><div class="half">PAN No.:</div><div class="half">
                                            {% for uploadeddocs in payreg.user_id.uploadeddocs_set.all %}
                                            {% if uploadeddocs.type1 == 'PAN Card' %}
                                                {% if uploadeddocs.id_no %} {{uploadeddocs.id_no}} {% endif %} &nbsp;
                                            {% endif %}
                                            {% endfor %}
                                        </div></div>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="mobile-res-wd" width="50%">
                                        <div class="d-flex h-100"><div class="half">Effective Work Days:</div><div class="half">{{num_days}}</div></div>
                                    </td>
                                    <td class="mobile-res-wd" width="50%">
                                        
                                    </td>
                                </tr>
                                <tr>
                                    <td class="mobile-res-wd" width="50%">
                                        <div class="d-flex h-100"><div class="half">LOP:</div><div class="half">
                                            {{total_lop}}
                                        </div></div>
                                    </td>
                                    <td width="50%"></td>
                                </tr>
                            </tbody>
                        </table>

                        <table class="ps-table-common br">
                            <tbody>
                                <tr class="Header">
                                    <td width="50%">
                                        <div class="d-flex h-100"><div class="half-75 mobile-res-65">Earnings</div><div class="half-25 mobile-res-35 text-right">Amount</div></div>
                                    </td>
                                    <td width="50%">
                                        <div class="d-flex h-100"><div class="half-75 mobile-res-65">Deductions</div><div class="half-25 mobile-res-35 text-right">Amount</div></div>
                                    </td>
                                </tr>
                                
                                <tr>
                                
                                    <td class="mobile-res-wd" width="50%">
                                        {% for data in assign_data %}
                                            {% for name, amount in data.zipped_data %}
                                                <div class="d-flex h-100"><div class="half-75">
                                                    {% for component in name.salarycomponent.all %}
                                                        {{ component.componentname }}
                                                    {% endfor %}
                                                </div>
                                                <div class="half-25 text-right">{{ amount.amount }}</div></div>
                                            {% endfor %}
                                        {% endfor %}

                                        {% for data in adhoc_data %}
                                        {% if data.adhocearning %}
                                        <div class="d-flex h-100"><div class="half-75">
                                            {{ data.adhocearning.component_name }}
                                        </div>
                                        <div class="half-25 text-right">{{data.amount}}</div></div>
                                        {% endif %}
                                        {% endfor %} 

                                    </td>
                                    
                                    <td class="mobile-res-wd" width="50%">
                                        {% for data in adhoc_data %}
                                        {% if data.adhocdeduction %}
                                        <div class="d-flex h-100"><div class="half-75">
                                            {{ data.adhocdeduction.component_name }}
                                        </div>
                                        <div class="half-25 text-right">{{data.amount}}</div></div>
                                        {% endif %}
                                        {% endfor %}

                                        <div class="d-flex h-100"><div class="half-75">
                                            LOP Amount
                                        </div>
                                        <div class="half-25 text-right">{{lopamount}}</div></div>
                                    </td>
                                    
                                </tr>

                                <tr class="footer">
                                    <td class="mobile-res-wd" width="50%">
                                        <div class="d-flex h-100"><div class="half-75 mobile-res-65">Total Earnings (Rs)</div><div class="half-25 mobile-res-35 text-right">{{total_earnings}}</div></div>
                                    </td>
                                    <td class="mobile-res-wd" width="50%">
                                        <div class="d-flex h-100"><div class="half-75 mobile-res-65">Total Deductions (Rs)</div>
                                        <div class="half-25 mobile-res-35 text-right">{{totaldeductions}}</div></div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>

                        <br>

                        <table class="ps-table-common mbott-10">
                            <tbody>
                                <tr>
                                    <td class="mobile-res-wd mtop-10 mbott-10" width="50%">
                                        <div class="d-flex h-100"><div class="half-75" style="font-weight: 600;">Net Pay for the Month:</div><div class="half-25 text-right"><span class="semibold">{{net_amount}}</span></div></div>
                                    </td>
                                    <td class="mobile-res-wd" width="50%"></td>
                                </tr>
                            </tbody>
                        </table>

                        <br>

                        <span class="amount-text m-0 text-capitalize" style="text-transform: capitalize; font-size: 15px;font-style: normal;">({{net_amount_words}})</span>

                        <div class="ps-wrapper-footer">
                            <hr class="ps-hr">
                            <p class="text-center m-0">This is a system generated payslip and does not require signature.</p>
                        </div>

                        </div>
                    </div>
                </div>

                <br>

                <form action="{% url 'download_emppayslip_pdf' %}?monthselect={{ month_str }}+{{ selected_year }}" method="post">
                    {% csrf_token %}
                    <p style="text-align: center;">
                        <button type="submit" class="btn btn-primary">Download</button>
                        <input hidden type="text" name="payreg_id" id="" value="{{payreg.id}}">
                        <input hidden type="text" name="month_str" id="" value="{{month_str}}">
                        <input hidden type="text" name="selected_year" id="" value="{{selected_year}}">
                    </p>
                </form>

                {% endfor %}

                {% if not payregister %}
                <p style="text-align: center;">Pay Slip is not generated</p>
                {% endif %}

                <br>
                
            </div>
        </div>
    </div>
    
    
<!-- js -->
<script src="static/index/vendors/scripts/core.js"></script>
	<script src="static/index/vendors/scripts/script.min.js"></script>
	<script src="static/index/vendors/scripts/process.js"></script>
	<script src="static/index/vendors/scripts/layout-settings.js"></script>
	<script src="static/index/src/plugins/jquery-steps/jquery.steps.js"></script>
	<script src="static/index/vendors/scripts/steps-setting.js"></script>
	
    <script>
        $(document).ready(function () {
            // Function to get URL parameter value by name
            function getUrlParameter(name) {
                name = name.replace(/[\[]/, '\\[').replace(/[\]]/, '\\]');
                var regex = new RegExp('[\\?&]' + name + '=([^&#]*)');
                var results = regex.exec(location.search);
                return results === null ? '' : decodeURIComponent(results[1].replace(/\+/g, ' '));
            }
    
            // Initialize a variable to store the selected date
            var urlSelectedDate = getUrlParameter('monthselect');
            var selectedDate = urlSelectedDate || new Date().toLocaleDateString('en-US', { month: 'long', year: 'numeric' });
    
            // Initialize datepicker
            $("#monthPicker").datepicker({
                dateFormat: 'MM yyyy',
                defaultDate: urlSelectedDate, // Set the default date from the URL parameter
    
                onSelect: function (date) {
                    // Update the selectedDate variable and the input field value
                    selectedDate = date;
                    console.log("Selected Date:", selectedDate);
                    
                    // Submit the form when the date is selected
                    $("#search-form").submit();
                }
            });
    
            // Set the initial value of the input field
            $("#monthPicker").val(selectedDate);
        });
    </script>

</body>
</html>
