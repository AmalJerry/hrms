<!DOCTYPE html>
<html>
<head>
    <!-- Basic Page Info -->
    <meta charset="utf-8">
    <title>HRMS</title>
    <link rel="icon" href="/static/logo/apple-touch-icon.png" type="image/x-icon">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css">

    <!-- Mobile Specific Metas -->
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <!-- Google Font -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <!-- CSS -->
    <link rel="stylesheet" type="text/css" href="static/index/vendors/styles/core.css">
    <link rel="stylesheet" type="text/css" href="static/index/vendors/styles/icon-font.min.css">
    <link rel="stylesheet" type="text/css" href="static/index/src/plugins/jquery-steps/jquery.steps.css">
    <link rel="stylesheet" type="text/css" href="static/index/vendors/styles/style.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-119386393-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-119386393-1');
    </script>

    
</head>
<body>

    <div class="header">
        <div class="header-left">
            <div class="menu-icon dw dw-menu"></div>
            
        </div>
        <div class="header-right">
            <div class="user-info-dropdown">
                <div class="dropdown">
                    <a class="dropdown-toggle" href="#" role="button" data-toggle="dropdown">
                        <span class="user-icon">
                            {% if k.image %}
                            <img src="{{ k.image.url }}" alt="" style="width: 100%; height:100% ">
                            {% else %}
                            <img src="/static/logo/userlogo.png" id="photo" style="width: 100%; height:100% ">
                            {% endif %} 
                         </span>
                        <span class="user-name">{{request.user.username}}</span>
                    </a>
                    <div class="dropdown-menu dropdown-menu-right dropdown-menu-icon-list">
                        <a class="dropdown-item" href="{% url 'empcreatepersonalinfo' %}"><i class="dw dw-user1"></i> Profile</a>
                        <a class="dropdown-item" href="{% url 'logout' %}"><i class="dw dw-logout"></i> Logout</a>
                    </div>
                </div>
            </div>
            
        </div>
    </div>

    <div class="right-sidebar">
        <div class="sidebar-title">
            <h3 class="weight-600 font-16 text-blue">
                 Settings
                <!--<span class="btn-block font-weight-400 font-12">User Interface Settings</span>-->
            </h3>
            <div class="close-sidebar" data-toggle="right-sidebar-close">
                <i class="icon-copy ion-close-round"></i>
            </div>
        </div>

        <div class="right-sidebar-body customscroll">
            <div class="right-sidebar-body-content">
                <h4 class="weight-600 font-18 pb-10" ><a href="{% url 'depart1' %}">Department</a> </h4>
                <h4 class="weight-600 font-18 pb-10"><a href="{% url 'desig1' %}">Designation</a></h4>
                <h4 class="weight-600 font-18 pb-10"><a href="{% url 'subdepartment' %}">Sub Department</a></h4>
            </div>
        </div>
    </div>

    <div class="left-side-bar">
        <div class="brand-logo mt-3">
        <a href="{% url 'dashboard' %}">
            {% if request.user.company_type %}
            {% if request.user.company_type.inverse_logo %}
            <img src="{{ request.user.company_type.inverse_logo.url }}" style="width: 100%; height: 100%;">
            {% else %}
            <img src="/static/logo/deskapp-logo-white.svg" alt="" class="light-logo">
            {% endif %}
            {% else %}
            <img src="/static/logo/deskapp-logo-white.svg" alt="" class="light-logo">
            {% endif %}
        </a>
        <div class="close-sidebar" data-toggle="left-sidebar-close">
           <i class="ion-close-round"></i>
        </div>
     </div><br>
      
       <div class="menu-block customscroll"> 
            <div class="sidebar-menu">
                <ul id="accordion-menu">
                    <li class="dropdown">
                    </li>
                    <li class="btn-primary active" style="background-color: black">
                        <a href="{% url 'empdash' %}" class="dropdown-toggle no-arrow">
                        <span class="micon dw dw-house-1"></span><span class="mtext"><b>Dashboard</b></span>
                        </a>
                    </li>
                    <li>
                        <a href="{% url 'empoverview' %}" class="dropdown-toggle no-arrow">
                        <span class="micon dw dw-building"></span><span class="mtext"><b>Company Profile</b></span>
                        </a>
                    </li>
                    <li>
                        <a href="{% url 'emppersonalinfonav' %}" class="dropdown-toggle no-arrow">
                        <span class="micon dw dw-user1"></span><span class="mtext"><b>My Profile</b></span>
                        </a>
                    </li>
                    <li>
                        <a href="{% url 'empleave' %}" class="dropdown-toggle no-arrow">
                        <span class="micon dw dw-calendar-1"></span><span class="mtext"><b>Leave</b></span>
                        </a>
                    </li>
                    <li>
                        <a href="{% url 'empdirectory' %}" class="dropdown-toggle no-arrow">
                        <span class="micon dw dw-list"></span><span class="mtext"><b>Directory</b></span>
                        </a>
                    </li>
                    <li>
                        <a href="{% url 'empdailylog' %}" class="dropdown-toggle no-arrow">
                        <span class="micon bi bi-check2-square"></span><span class="mtext"><b>Attendance</b></span>
                        </a>
                    </li>
                    <li>
                        <a href="{% url 'emp_calender' %}" class="dropdown-toggle no-arrow">
                        <span class="micon dw dw-calendar"></span><span class="mtext"><b>Holiday Calendar</b></span>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    <div class="main-container" >
                   <div class="card-box height-100-px overflow-hidden">
                        <ul class="nav nav-tabs customtab" role="tablist">

                <li class="nav-item">
                    <a class="nav-link "  href="{% url 'emppersonalinfonav' %}" >Personal</a>
                </li>
                <li class="nav-item" >
                    <a class="nav-link"  href="{% url 'empworknav' %}" >Work</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link"  href="{% url 'empteamnav' %}" >Team</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link"  href="{% url 'empeducationnav' %}" >Education</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link"  href="{% url 'empfamilynav' %}" >Family</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="{% url 'empdocumentsnav' %}" >Documents</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="{% url 'empworkweeknav' %}" >Work Week</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="{% url 'emppayrollnav' %}" >Payroll</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link active" href="{% url 'empe_exit' %}">E-Exit</a>
                </li>
                <!-- <li class="nav-item">
                    <a class="nav-link" href="{% url 'empfilemanagernav' %}" >File Manager</a>
                </li> -->

                        </ul>
                       
                <div class="pd-20 card-box mb-30" style="margin-bottom: 0;">
                                                                                     
                         <div class="modal fade bs-example-modal-lg" id="apply" >
                             <div class="modal-dialog modal-lg modal-dialog-centered" >
                                 <div class="modal-content">
                                     <div class="modal-header">
                                         <h4 class="modal-title">Resignation Form</h4>
                                         <button type="button" class="close" data-dismiss="modal">&times;</button>
                                     </div>
                                     <div class="modal-body">
                                         <form action="{% url 'empadd_e_exit' %}" method="post" enctype="multipart/form-data" class="form-container" role="form">
                                             {% csrf_token %}
                                             <div class="row">

                                                 <div class="col-md-6">
                                                     <div class="form-group">
                                                         <label>Date of Resignation</label><span style="color:red">&#42</span>
                                                         <input class="form-control" placeholder="Select Date" type="text" name="resignation_date" id="resignation_date" required>
                                                     </div>
                                                 </div>

                                                 <div class="col-md-6">
                                                     <div class="form-group">
                                                         <label>Reason for Leaving</label><span style="color:red">&#42</span>
                                                         <select class="custom-select form-control" name="reason" required>
                                                             <option value="" selected >Select Reason</option>
                                                             <option>Resignation</option>
                                                             <option>Retirement</option>
                                                             <option>End of Contract</option>
                                                             <option>Voluntary Separation</option>
                                                             <option>Termination</option>
                                                             <option>Layoff</option>
                                                             <option>Relocation</option>
                                                             <option>Career Change</option>
                                                             <option>Personal Reasons</option>
                                                             <option>Promotion/Internal Transfer</option>
                                                             <option>Higher Education Pursuit</option>
                                                             <option>Health Issues</option>
                                                             <option>Family Responsibilities</option>
                                                             <option>Company Restructuring</option>
                                                             <option>Dissatisfaction with the Work Environment</option>
                                                             <option>Unfulfilled Growth Opportunities</option>
                                                             <option>Change in the Job Market</option>
                                                             <option>Entrepreneurship/Starting Own Business</option>
                                                             <option>Job Redundancy</option>
                                                             <option>End of Project/Contract Completion</option>
                                                             <option>Others</option>
                                                         </select>                                                                    
                                                     </div>
                                                 </div>
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label>Actual Last Working Day</label><span style="color:red">&#42</span>
                                                        <input class="form-control" placeholder="Auto-filled based on your resignation date" type="text" name="actual_last_working_day" id="actual_last_working_day" readonly>
                                                    </div>
                                                </div>

                                                 <div class="col-md-6">
                                                     <div class="form-group">
                                                         <label>Last Working Day Requested</label><span style="color:red">&#42</span>
                                                         <input class="form-control"  placeholder="Select Date" type="text" name="last_workingday" id="last_workingday" required >
                                                     </div>
                                                 </div>
                                                 

                                                 <div class="col-md-6">
                                                     <div class="form-group">
                                                         <label>Notice Period Days</label><span style="color:red">&#42</span>
                                                         <input type="text" class="form-control" id="notice_period" name="notice_period" value="60" max="60" min="0" readonly>  
                                                     </div>
                                                 </div>

                                                 <div class="col-md-6">
                                                     <div class="form-group">
                                                         <label>Shortfall/Excess in Notice Period days</label><span style="color:red">&#42</span>
                                                         <input type="number" min="0" max="60" placeholder="Enter a Number" class="form-control" id="Shortfall" name="Shortfall" required >  
                                                     </div>
                                                 </div>

                                                 <div class="col-md-6">
                                                     <div class="form-group">
                                                         <label>Personal Email</label><span style="color:red">&#42</span>
                                                         <input type="text" class="form-control" value={{request.user.email}} readonly >  
                                                     </div>
                                                 </div>
                                                 
                                             </div>

                                             <div class="row">
                                                 <div class="col-md-12">
                                                     <div class="form-group">
                                                         <label>Resignation Letter</label><span style="color:red">&#42</span>
                                                         <textarea class="form-control" name="resignation_letter" id="resignation_letter" required></textarea>
                                                     </div>
                                                 </div>
                                             </div>

                                             <div class="modal-footer">
                                                 <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>        
                                                 <button type="submit" class="btn btn-primary" onsubmit="hideadd">Submit</button>
                                             
                                             </div>
                                         </form>
                                     </div>
                                 </div>
                             </div>
                         </div>
                           
                         {% for i in resignation %}
                        <hr>   
                        <div class="card shadow-sm mb-4 border">
                            <div class="card-header bg-info text-white text-center">
                                <strong>Resignation Details</strong>
                            </div>
                            <div class="card-body">
                                <div class="row g-4">
                                    <div class="col-md-4">
                                        <div class="p-2 border rounded bg-light me-2 mt-2 mb-2">
                                            <strong>Resignation Date</strong>
                                            <p class="mb-0 fw-semibold text-dark">{{ i.resignation_date|date:"d M Y" }}</p>
                                        </div>
                                    </div>

                                        <div class="col-md-4">
                                            <div class="p-2 border rounded bg-light me-2 mt-2 mb-2">
                                                <strong> Actual Last Working Day</strong>
                                                <p class="mb-0 fw-semibold text-dark">{{ i.actual_last_working_day }}</p>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="p-2 border rounded bg-light me-2 mt-2 mb-2">
                                                <strong> Requested Last Working Day</strong>
                                                <p class="mb-0 fw-semibold text-dark">{{ i.last_workingday }}</p>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="p-2 border rounded bg-ligh me-2 mt-2 mb-2t">
                                                <strong>Reason</strong> 
                                                <p class="mb-0 fw-semibold text-dark"> {{ i.reason }} </p>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="p-2 border rounded bg-light me-2 mt-2 mb-2">
                                                <strong>Notice Perirod</strong>
                                                <p class="mb-0 fw-semibold text-dark">{{ i.notice_period }}</p>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="p-2 border rounded bg-light me-2 mt-2 mb-2">
                                                <strong>Shortfall/Excess in Notice Period days</strong> 
                                                <p class="mb-0 fw-semibold text-dark">{{ i.Shortfall }}</p>
                                            </div>
                                        </div>
                                        <div class="col-md-12">
                                            <div class="p-2 border rounded bg-light me-2 mt-2 mb-2">
                                                <strong>Resignation Letter</strong> 
                                                <p class="mb-0 fw-semibold text-dark">{{ i.resignation_letter }}</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                {% if i.status == "Pending" %}
                                <div class="d-flex text-center justify-content-center mb-4">

                                    {% if i.allow_edit %}
                                    <button type="button" title="You can only edit the form once" class="btn btn-sm btn-info"
                                        data-toggle="modal" data-target="#editResignationModal{{ i.id }}">
                                        Update
                                    </button>
                                    {% else %}
                                    <button type="button"
                                        title="To edit this form, please contact the HR team for permission."
                                        class="btn btn-sm btn-secondary text-white"
                                        style="background-color: #6c757d !important; border-color: #6c757d !important;">
                                        Edit not allowed
                                    </button>
                                    {% endif %}

                                    <div class="col-md-2">
                                        <a onclick="return confirm('Are you sure to delete?')" href="{% url 'empdelete_resignation' id=i.id %}">
                                            <button type="button" class="btn btn-sm btn-danger">
                                                <i class="fa fa-trash" style="font-size:24px; color:rgb(255, 255, 255)" title="Delete"></i>
                                            </button>
                                        </a>
                                    </div>

                                </div>
                                {% endif %}

                            <div class="text-center justify-content-center">
                                {% if i.status == 'Approved' %}
                                    <div class="alert alert-success mt-3">✅ Your resignation is <strong>Approved</strong> by the Admin. Kindly Contact HR for your Experience Certificate</div>
                                {% elif i.status == 'Rejected' %}
                                    <div class="alert alert-danger mt-3">
                                        ❌ Your resignation was <strong>Rejected</strong> by the Admin.
                                        {% if i.rejection_reason %}
                                            <br><strong>Reason:</strong> {{ i.rejection_reason }}
                                        {% endif %}
                                    </div>
                                {% elif i.status == 'Pending' %}
                                    <div class="alert alert-warning mt-3">⏳ Your resignation is currently <strong>Pending</strong>. Kindly Contact HR to quick resolution. </div>
                                {% elif i.status == 'Updated' %}
                                    <div class="alert alert-info mt-3">⚠️ Update from Admin: {{ i.update_message }}</div>
                                {% endif %}
                            </div>
                        </div>
                    </div><hr>
                </div>
                                    <div class="modal fade" id="editResignationModal{{ i.id }}" tabindex="-1" role="dialog" aria-labelledby="editResignationModalLabel" aria-hidden="true">
                                        <div class="modal-dialog modal-xl" role="document">
                                            <div class="modal-content">
                                            <div class="modal-header bg-warning text-dark">
                                                <h5 class="modal-title" id="editResignationModalLabel">Edit Resignation</h5>
                                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                <span aria-hidden="true">&times;</span>
                                                </button>
                                            </div>
                                        <div class="modal-body">
                                            <form action="{% url 'edit_resignation' i.id %}" method="post" enctype="multipart/form-data" class="form-container" role="form">
                                                {% csrf_token %}
                                                    <div class="row">
                                                        <div class="col-md-6">
                                                            <div class="form-group">
                                                                <label>Date of Resignation</label><span style="color:red">&#42</span>
                                                                <input class="form-control date-picker"  placeholder="Select Date" type="text" name="resignation_date" id="resignation_date" value="{{ i.resignation_date|date:'Y-m-d' }}" required >
                                                            </div>
                                                        </div>
                                
                                                        <div class="col-md-6">
                                                            <div class="form-group">
                                                                <label>Reason for Leaving</label><span style="color:red">&#42</span>
                                                                <select class="custom-select form-control" name="reason" required>
                                                                    <option value="" selected >Select Reason</option>
                                                                    <option value="Resignation" {% if i.reason == 'Resignation' %}selected{% endif %}>Resignation</option>
                                                                    <option value="Retirement" {% if i.reason == 'Retirement' %}selected{% endif %}>Retirement</option>
                                                                    <option value="End of Contract" {% if i.reason == 'End of Contract' %}selected{% endif %}>End of Contract</option>
                                                                    <option value="Voluntary Separation" {% if i.reason == 'Voluntary Separation' %}selected{% endif %}>Voluntary Separation</option>
                                                                    <option value="Termination" {% if i.reason == 'Termination' %}selected{% endif %}>Termination</option>
                                                                    <option value="Layoff" {% if i.reason == 'Layoff' %}selected{% endif %}>Layoff</option>
                                                                    <option value="Relocation" {% if i.reason == 'Relocation' %}selected{% endif %}>Relocation</option>
                                                                    <option value="Career Change" {% if i.reason == 'Career Change' %}selected{% endif %}>Career Change</option>
                                                                    <option value="Personal Reasons" {% if i.reason == 'Personal Reasons' %}selected{% endif %}>Personal Reasons</option>
                                                                    <option value="Promotion/Internal Transfer" {% if i.reason == 'Promotion/Internal Transfer' %}selected{% endif %}>Promotion/Internal Transfer</option>
                                                                    <option value="Higher Education Pursuit" {% if i.reason == 'Higher Education Pursuit' %}selected{% endif %}>Higher Education Pursuit</option>
                                                                    <option value="Health Issues" {% if i.reason == 'Health Issues' %}selected{% endif %}>Health Issues</option>
                                                                    <option value="Family Responsibilities" {% if i.reason == 'Family Responsibilities' %}selected{% endif %}>Family Responsibilities</option>
                                                                    <option value="Company Restructuring" {% if i.reason == 'Company Restructuring' %}selected{% endif %}>Company Restructuring</option>
                                                                    <option value="Dissatisfaction with the Work Environment" {% if i.reason == 'Dissatisfaction with the Work Environment' %}selected{% endif %}>Dissatisfaction with the Work Environment</option>
                                                                    <option value="Unfulfilled Growth Opportunities" {% if i.reason == 'Unfulfilled Growth Opportunities' %}selected{% endif %}>Unfulfilled Growth Opportunities</option>
                                                                    <option value="Change in the Job Market" {% if i.reason == 'Change in the Job Market' %}selected{% endif %}>Change in the Job Market</option>
                                                                    <option value="Entrepreneurship/Starting Own Business" {% if i.reason == 'Entrepreneurship/Starting Own Business' %}selected{% endif %}>Entrepreneurship/Starting Own Business</option>
                                                                    <option value="Job Redundancy" {% if i.reason == 'Job Redundancy' %}selected{% endif %}>Job Redundancy</option>
                                                                    <option value="End of Project/Contract Completion" {% if i.reason == 'End of Project/Contract Completion' %}selected{% endif %}>End of Project/Contract Completion</option>
                                                                    <option value="Others" {% if i.reason == 'Others' %}selected{% endif %}>Others</option>
                                                                </select>                                                                    
                                                            </div>
                                                        </div>
                                                        <div class="col-md-6">
                                                            <div class="form-group">
                                                                <label>Actual Last Working Day</label><span style="color:red">&#42</span>
                                                                <input class="form-control "placeholder="Auto-filled based on your resignation date"  type="text" name="actual_last_working_day" id="actual_last_working_day" value="{{ i.actual_last_working_day|date:'Y-m-d' }}" readonly >
                                                            </div>
                                                        </div>
                                
                                                        <div class="col-md-6">
                                                            <div class="form-group">
                                                                <label>Last Working Day Requested</label><span style="color:red">&#42</span>
                                                                <input class="form-control"  placeholder="Select Date" type="text" name="last_workingday" id="last_workingday" value="{{ i.last_workingday|date:'Y-m-d' }}" required >
                                                            </div>
                                                        </div>
                                
                                                        <div class="col-md-6">
                                                            <div class="form-group">
                                                                <label>Notice Period Days</label>
                                                                <input type="text" class="form-control" id="notice_period" name="notice_period" value="{{ i.notice_period }}">  
                                                            </div>
                                                        </div>
                                
                                                        <div class="col-md-6">
                                                            <div class="form-group">
                                                                <label>Shortfall/Excess in Notice Period days</label><span style="color:red">&#42</span>
                                                                <input type="text" class="form-control" id="Shortfall" name="Shortfall" value="{{ i.Shortfall }}" required >  
                                                            </div>
                                                        </div>
                                
                                                        <div class="col-md-6">
                                                            <div class="form-group">
                                                                <label>Personal Email</label>
                                                                <input type="text" class="form-control" value={{request.user.email}} readonly >  
                                                            </div>
                                                        </div>
                                                        
                                                    </div>
                                
                                                    <div class="row">
                                                        <div class="col-md-12">
                                                            <div class="form-group">
                                                                <label>Resignation Letter</label><span style="color:red">&#42</span>
                                                                <textarea class="form-control" name="resignation_letter" id="resignation_letter" required>{{ i.resignation_letter }}</textarea>
                                                            </div>
                                                        </div>
                                                    </div>
                                
                                                    <div class="modal-footer">
                                                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>        
                                                        <button type="submit" class="btn btn-primary">Submit</button>
                                                    </div>
                                                </form>
                                            </div>
                                           </div>
                                        </div>
                                    </div>

                        {% empty %}

                                <div style="margin-left: 35%;">
                                    <a href=""  type="button" class="btn btn-info btn-sm " data-toggle="modal" data-target="#apply">Apply for Resignation</a>
                                </div>
                                
                            </div>
                        {% endfor %}

            </div>
        </div>
    
    </div>
       
    



 <!-- js -->
 <script src="static/index/vendors/scripts/core.js"></script>
 <script src="static/index/vendors/scripts/script.min.js"></script>
 <script src="static/index/vendors/scripts/process.js"></script>
 <script src="static/index/vendors/scripts/layout-settings.js"></script>
 <script src="static/index/src/plugins/jquery-steps/jquery.steps.js"></script>
 <script src="static/index/vendors/scripts/steps-setting.js"></script>
 <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>
 

<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
<script>
    flatpickr("#resignation_date", {
        dateFormat: "Y-m-d",
        onChange: function (selectedDates, dateStr) {
            const resDate = new Date(dateStr);
            const approvedInput = document.getElementById("actual_last_working_day");

            if (!resDate || isNaN(resDate.getTime())) return;

            // Add 60 calendar days
            const approvedDate = new Date(resDate);
            approvedDate.setDate(approvedDate.getDate() + 60);

            // If it's Sunday, move to Saturday
            if (approvedDate.getDay() === 0) {
                approvedDate.setDate(approvedDate.getDate() - 1);
            }

            // Format YYYY-MM-DD
            const yyyy = approvedDate.getFullYear();
            const mm = String(approvedDate.getMonth() + 1).padStart(2, '0');
            const dd = String(approvedDate.getDate()).padStart(2, '0');

            approvedInput.value = `${yyyy}-${mm}-${dd}`;
        }
    });

    // Also apply flatpickr to the other date fields
    flatpickr("#last_workingday", { dateFormat: "Y-m-d" });
</script>


<script>
    document.addEventListener("DOMContentLoaded", function () {
        const resignationInput = document.getElementById("resignation_date");
        const approvedInput = document.getElementById("actual_last_working_day");

        resignationInput.addEventListener("change", function () {
            const resDateStr = this.value;
            if (!resDateStr) return;

            const resDate = new Date(resDateStr);
            const approvedDate = new Date(resDate);

            approvedDate.setDate(resDate.getDate() + 60); // Add 60 days

            // If it's Sunday (0), shift to previous Saturday (6)
            if (approvedDate.getDay() === 0) {
                approvedDate.setDate(approvedDate.getDate() - 1);
            }

            const yyyy = approvedDate.getFullYear();
            const mm = String(approvedDate.getMonth() + 1).padStart(2, '0');
            const dd = String(approvedDate.getDate()).padStart(2, '0');

            approvedInput.value = `${yyyy}-${mm}-${dd}`;
        });
    });
</script>


</body>
</html>