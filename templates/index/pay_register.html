<!DOCTYPE html>
<html>
{% load static %}
{% load custom_tags %}

<head>
	<!-- Basic Page Info -->
	
	<meta charset="utf-8">
	<title>HRMS</title>
    <link rel="icon" href="/static/logo/apple-touch-icon.png" type="image/x-icon">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
     
	<!-- Site favicon -->
	<link rel="apple-touch-icon" sizes="180x180" href="static/index/vendors/images/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="static/index/vendors/images/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="static/index/vendors/images/favicon-16x16.png">

	<!-- Mobile Specific Metas -->
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<!-- Google Font -->
	<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
	<!-- CSS -->
	<link rel="stylesheet" type="text/css" href="/static/index/vendors/styles/core.css">
	<link rel="stylesheet" type="text/css" href="/static/index/vendors/styles/icon-font.min.css">
	<link rel="stylesheet" type="text/css" href="/static/index/src/plugins/datatables/css/dataTables.bootstrap4.min.css">
	<link rel="stylesheet" type="text/css" href="/static/index/src/plugins/datatables/css/responsive.bootstrap4.min.css">
	<link rel="stylesheet" type="text/css" href="/static/index/vendors/styles/style.css">

	<!-- Jquery -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"
		integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g=="
		crossorigin="anonymous" referrerpolicy="no-referrer"></script>

	<!-- Data table css -->
	<link rel="stylesheet" href="https://cdn.datatables.net/2.0.7/css/dataTables.dataTables.css" />
	<script src="https://cdn.datatables.net/2.0.7/js/dataTables.js"></script>

	<!-- Global site tag (gtag.js) - Google Analytics -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=UA-119386393-1"></script>
	<script>
		window.dataLayer = window.dataLayer || [];
		function gtag(){dataLayer.push(arguments);}
		gtag('js', new Date());

		gtag('config', 'UA-119386393-1');
	</script>

<style>
	.circular-button {
		border-radius: 50%;
		width: 40px;
		height: 40px;
		display: flex;
		justify-content: center;
		align-items: center;
		text-align: center;
	}

	.larger-icon {
		font-size: 24px;
	}

	.container-with-scrollbar {
		max-height: 100px;
		overflow-y: auto;
		border: 2px solid rgb(213, 209, 209);
	}

	.rule-badge {
		display: inline-block;
		padding: 5px 10px;
		border-radius: 50px;
		background-color: white;
		font-size: 15px;
		position: relative;
		margin-top: 5px;
		margin-left: 5px;
		margin-bottom: 5px;
		border: 2px solid rgb(213, 209, 209);
	}

	.emp_count {
		display: inline-block;
		padding: 5px 10px;
		border-radius: 50px;
		background-color: lightgray;
		font-size: 15px;
		position: relative;
		margin-top: 5px;
		margin-left: 5px;
		margin-bottom: 5px;
		border: 2px solid rgb(213, 209, 209);
	}

	.optional-field {
		display: inline-block;
		padding: 5px 10px;
	}

	.check-box {
		transform: scale(1.5);
		margin-right: 5px;
	}

	 th {
            top: -2px;
            background-color: #fff;
            white-space: nowrap;
            text-align: left !important;
            z-index: 10;
        }
    
        td {
            border: 1px solid #e0e0e0;
            background-color: #fff;
        }
    
        th:nth-child(1),
        td:nth-child(1) {
            position: sticky;
            left: -1px;
            width: 0;
            background-color: #fff;
            z-index: 30;
        }
    
        th:nth-child(2),
        td:nth-child(2) {
            position: sticky;
            left: 39px;
            width: 5%;
            background-color: #fff;
            z-index: 25;
    
        }
		th:nth-child(3),
        td:nth-child(3) {
            position: sticky;
            left: 105px;
            width: 5%;
            background-color: #fff;
            z-index: 20;
    
        }
    
        tr:nth-child(even) td {
            background: #fff;
        }
    
        tr:nth-child(odd) td {
            background: #eaeef2;
        }
    
        tbody td:nth-child(n+2):nth-child(-n+14):hover {
            cursor: pointer;
        }
    
        div.dt-container {
            width: 100%;
            margin: 0 auto;
        }
    
        #dt-length-0 {
            margin-right: 0.5rem !important;
        }

</style>

</head>
<body>
	       <div class="d-flex flex-row justify-content-end align-items-baseline align-content-end flex-wrap ml-auto" >
			
			<div class="header">
				<div class="header-left" >
					<div class="menu-icon dw dw-menu"></div>
					<div class="search-toggle-icon dw dw-search2" data-toggle="header_search"></div>
					<div class="header-search">
						<form action="{% url 'pay_register' %}" method="GET">
							<div class="form-group mb-0">
								<i class="dw dw-search2 search-icon"></i>
								<input type="text" data-live-search="true" class="form-control search-input" name="search" {% if query is None %} placeholder="Search " {% else %} value="{{query}}" {% endif %}>
								<span onclick="var input = this.previousElementSibling; input.value = ''; input.focus(); " style="position: absolute;margin-left:470px; margin-top:-35px;cursor:pointer" id="cross">		
									<a href="{% url 'pay_register' %}" style="color: grey;">x</a>
								</span>
		
								<div class="dropdown">
									<button class="btn-primary dropdown-toggle no-arrow"  role="button">	 
										<i class="fa fa-search"  style="color:White" ></i>
									</button>
								</div>
							</div>
						</form>
					</div>
				</div>
				<div class="d-flex flex-row justify-content-end align-items-baseline align-content-end flex-wrap ml-auto" >
			
					<form action="{% url 'pay_register' %}" method="get" id="search-form">
			
						<div class="user-info-dropdown" id="search">
							<div class="dropdown">
								<div class="input-group">
									<div class="form-group">
								<input id="monthPicker" name="monthselect" class="form-control month-picker" type="text" style="margin-top: 4%;margin-left: -10%;"    />
								
								</div>
								<span onclick="var input = this.previousElementSibling; input.value = ''; input.focus(); "
								style="position: absolute;margin-left: 80%;margin-top: 9%;cursor:pointer" id="cross">
								<a href="{% url 'pay_register' %}" style="color: grey;">x</a>
							</span>
		
								</div>
							</div>
						</div>
					</form>
					</div>
						
				
			
			<div class="user-info-dropdown">
				<div class="dropdown">
					<a class="dropdown-toggle" href="#" role="button" data-toggle="dropdown">
						<span class="user-icon">
							{% if k.image %}
                            <img src="{{ k.image.url }}" alt="" style="width: 100%; height:100% ">
                        {% else %}
						<img src="/static/logo/userlogo.png" id="photo" style="width: 100%; height:100% ">
                        {% endif %}  						</span>
						<span class="user-name">{{request.user.username}}</span>
					</a>
					<div class="dropdown-menu dropdown-menu-right dropdown-menu-icon-list">
						<a class="dropdown-item" href="{% url 'createpersonalinfo' %}"><i class="dw dw-user1"></i> Profile</a>
						<a class="dropdown-item" href="{% url 'department' %}" data-toggle="right-sidebar"><i class="dw dw-settings2"></i> Settings</a>
						<a class="dropdown-item" href="{% url 'help_page' %}"><i class="dw dw-help"></i> Help</a>
						<a class="dropdown-item" href="{% url 'logout' %}"><i class="dw dw-logout"></i> Logout</a>
					</div>
				</div>
			</div>
			
		</div>
	</div>

	<div class="left-side-bar">
        <div class="brand-logo mt-3">
		<a href="{% url 'dashboard' %}">
			{% if request.user.company_type %}
				{% if request.user.company_type.inverse_logo %}
				<img src="{{ request.user.company_type.inverse_logo.url }}" style="width: 100%; height: 100%;">
				{% else %}
				<img src="/static/logo/deskapp-logo-white.svg" alt="" class="light-logo">
				{% endif %}
				{% else %}
				<img src="/static/logo/deskapp-logo-white.svg" alt="" class="light-logo">
				{% endif %}
		</a>
        <div class="close-sidebar" data-toggle="left-sidebar-close">
           <i class="ion-close-round"></i>
        </div>
     </div>
      
       <div class="menu-block customscroll">
            <div class="sidebar-menu">
                <ul id="accordion-menu">
					
					<br>
					<li class="btn-primary active" style="background-color:black">
						<a href="{% url 'dashboard' %}" class="dropdown-toggle no-arrow">
							<span class="micon dw dw-house-1"></span><span class="mtext"><b>Dashboard</b></span>
						</a>
					</li>
					
					<li>
						<a href="{% url 'companyprofile' %}" class="dropdown-toggle no-arrow">
							<span class="micon dw dw-building"></span><span class="mtext"><b>Company Profile</b></span>
						</a>
					</li>
					<li>
						<a href="{% url 'personalinfonav' %}" class="dropdown-toggle no-arrow">
							<span class="micon dw dw-user1"></span><span class="mtext"><b>My Profile</b></span>
						</a>
					</li>
					<li>
						<a href="{% url 'leave' %}" class="dropdown-toggle no-arrow">
							<span class="micon dw dw-calendar-1"></span><span class="mtext"><b>Leave</b></span>
						</a>
					</li>
					<li>
						<a href="{% url 'directory' %}" class="dropdown-toggle no-arrow">
							<span class="micon dw dw-list"></span><span class="mtext"><b>Directory</b></span>
						</a>
					</li>
					<li>
						<a href="{% url 'dailylog' %}" class="dropdown-toggle no-arrow">
							<span class="micon bi bi-check2-square"></span><span class="mtext"><b>Attendance</b></span>
						</a>
					</li>
					<li>
						<a href="{% url 'calender' %}" class="dropdown-toggle no-arrow">
							<span class="micon dw dw-calendar"></span><span class="mtext"><b>Holiday Calendar</b></span>
						</a>
					</li>
					<li>
						<a href="{% url 'runpayroll_overview' %}" class="dropdown-toggle no-arrow">
							<span class="micon dw dw-money-2"></span><span class="mtext"><b>Payroll</b></span>
						</a>
					</li>


				</ul>
            </div>
        </div>
    </div>
	

	<div class="mobile-menu-overlay"></div>

	<div class="main-container">
		<div class="card-box">
			<ul class="nav nav-tabs customtab" role="tablist" >
                
                <li class="nav-item">
                    <a class="nav-link active" href="{% url 'runpayroll_overview' %}">Run Payroll</a>
                </li>

				<li class="nav-item">
					<a class="nav-link "  href="{% url 'create_salary' %}" >Setup Payroll</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="{% url 'payroll_dec' %}" >Declaration</a>
				</li>

				<!-- <li class="nav-item">
                    <a class="nav-link" href="{% url 'create_salary' %}">Create Salary Structure</a>
                </li>

				<li class="nav-item">
					<a class="nav-link "  href="{% url 'view_assign_salarystructure' %}" >Assign Salary Structure</a>
				</li> -->

				<!-- <li class="nav-item">
					<a class="nav-link" href="{% url 'payroll_dec' %}" >Declaration</a>
				</li> -->
				<!-- <li class="nav-item">
					<a class="nav-link" href="" >Advanced Settings</a>
				</li> -->
				<!-- <li class="nav-item">
					<a class="nav-link" href="" >Audit History</a>
				</li> -->
				<!-- <li class="nav-item">
					<a class="nav-link" href="" >Statutory</a>
				</li> -->

                <!-- <li class="nav-item">
                    <a class="nav-link" href="{% url 'verify' %}">Verify</a>
                </li> -->
                
            </ul>
			<div class="min-height-100px">
				<!-- <div class="tab height-100-p"> -->
					<!-- <br><h4 class="text-blue h4" style="padding-left:30px">Payroll</h4> -->
					<ul class="nav nav-tabs customtab" role="tablist">
						<li class="nav-item">
							<a class="nav-link" href="{% url 'runpayroll_overview' %}">Overview</a>
						</li>
						<li class="nav-item">
							<a class="nav-link " href="{% url 'runpayroll' %}">Attendance & Leave</a>
						</li>
						<li class="nav-item">
							<a class="nav-link " href="{% url 'salary_revision' %}">Salary Revision</a>
						</li>
						<li class="nav-item">
							<a class="nav-link active" href="{% url 'pay_register' %}">Pay Register</a>
						</li>
						<li class="nav-item">
							<a class="nav-link " href="{% url 'payout' %}">Payout</a>
						</li>
						<li class="nav-item">
							<a class="nav-link" href="{% url 'adhoc' %}">Variable & Adhoc</a>
						</li>
						<li class="nav-item">
							<a class="nav-link" href="{% url 'salary_onhold' %}">Salary on Hold</a>
						</li>
						<!-- <li class="nav-item">
							<a class="nav-link" href="">Tax Override</a>
						</li> -->
					</ul>
					
			</div>
			

							<div class="pd-20 card-box">
								<form method="post" id="FormId" >
									{% csrf_token %}
							
									<input hidden type="text" value="{{month_str}}" name="monthselect">
									<input hidden type="text" value="{{selected_year}}" name="yearselect">
							
									<input hidden id="actionType" name="actionType" value="">
							
									<div class="row pull-right">
										<div class="col-md-12">
											<a data-toggle="modal" href="#revert" class="btn btn-danger btn-sm ">Revert</a>
							
											<a data-toggle="modal" href="#calculate" class="btn btn-sm"
												style="color: #fff;background: rgb(244, 111, 48);">Calculate</a>
							
											<a data-toggle="modal" href="#rupayroll" class="btn btn-success btn-sm ">Run Payroll</a>
							
											<a data-toggle="modal" href="#genpayslip" class="btn btn-info btn-sm ">Generate Payslip</a>
							
											<!-- <a data-toggle="modal" href="#pay" class="btn btn-success btn-sm ">Pay</a>
														
																								<a data-toggle="modal" href="#hold" class="btn btn-danger btn-sm ">Hold</a> -->
							
											<a type="button" data-toggle="modal" href="#" class="btn btn-primary btn-sm"
												onclick="setActionType('download')">Download</a>
							
										</div>
									</div>
									
									<br><br>
									
										<table id="data_Table" class=" table table-striped" style="width:100%">
											<thead>
												<tr>
													<th>
														<div class="dt-checkbox">
															<input type="checkbox" name="select_all" value="1" id="select-all-checkbox">
															<span class="dt-checkbox-label"></span>
														</div>
													</th>
													<th>Emp Id</th>
													<th>Name</th>
													<th>Location</th>
													<th>Department</th>
													<th>Designation</th>
													<th>PAN</th>
													<th>Bank Name</th>
													<th>Bank Account</th>
													<th>No. Of Days</th>
													<th>Working Days</th>
													<th>WFO</th>
													<th>Penalty</th>
													<th>LOP</th>
													<th>Payout Status</th>
													{% for unique_component in unique_components %}
													<th>{{ unique_component }}</th>
													{% endfor %}
													{% for component_name in component_names %}
													<th>{{ component_name }}</th>
													{% endfor %}
													<th>Net Pay</th>
													<th>Payroll Status</th>
							
												</tr>
											</thead>
											<tbody>
												{% for i in user_list %}
												<tr>
													<td>
														<div class="dt-checkbox">
															<input type="checkbox" style="transform: scale(1.5);" class="employee-checkbox"
																name="selected_employees" value="{{ i.id }}">
															<span class="dt-checkbox-label"></span>
														</div>
													</td>
													<td> <a href="/view_personalinfo{{ i.id }}">{{i.empid}}</a></td>
													<td><a href="/view_personalinfo{{ i.id }}">{{i.username }}</a> </td>
													<td>{{i.wrklcn.location}}</td>
													<td>{{ i.department.name }}</td>
													<td>{{ i.designation.name }}</td>
													<td>
														{% for uploadeddocs in i.uploadeddocs_set.all %}
														{% if uploadeddocs.type1 == 'PAN Card' %}
														{% if uploadeddocs.id_no %} {{uploadeddocs.id_no}} {% endif %}
														{% endif %}
														{% endfor %}
													</td>
													<td>
														{% for bankaccount in i.bank_account_set.all %}
														{% if bankaccount %} {{bankaccount.bank_name}} {% endif %}
														{% endfor %}
													</td>
													<td>
														{% for bankaccount in i.bank_account_set.all %}
														{% if bankaccount %} {{bankaccount.account_number}} {% endif %}
														{% endfor %}
													</td>
							
													<td>{{num_days}}</td>
							
													<td>
														{% for userdata in user_data %}
														{% if userdata.user.id == i.id %}
														{{ userdata.total_working_days }}
														{% endif %}
														{% endfor %}
													</td>

													<td>
														{% for userdata in user_data %}
														{% if userdata.user.id == i.id %}
														{{ userdata.wfo_count }}
														{% endif %}
														{% endfor %}
													</td>
							
													<td>
														{% for userdata in user_data %}
														{% if userdata.user.id == i.id %}
														{{ userdata.absent_AN_count }}
														{% endif %}
														{% endfor %}
													</td>
							
													<td>
														{{ user_lop_counts|get_item:i.id|default:0 }}
														{% comment %} {% for lop in lopcount %}
														{% if lop.user_id.id == i.id %}
														{{lop.lop_count}}
														{% endif %}
														{% endfor %} {% endcomment %}
													</td>
							
													<td>
														{% for payoutdata in payout_data %}
														{% if payoutdata.user_id.id == i.id %}
														{{payoutdata.status}}
														{% endif %}
														{% endfor %}
													</td>
							
													{% for unique_component in unique_components %}
													<td style="text-align: right;">
														{% for user_data_item in user_data %}
														{% if user_data_item.user.id == i.id %}
														{% for component, amount in user_data_item.data %}
														{% if component == unique_component %}
														{{ amount }}
														{% endif %}
														{% endfor %}
														{% endif %}
														{% endfor %}
													</td>
													{% endfor %}
							
							
													{% for component_name in component_names %}
													{% for user_data in aggregated_data %}
													{% if user_data.user.id == i.id %}
													<td style="text-align: right;">
														{% for adhoc_entry in user_data.adhoc_data %}
														{% if adhoc_entry.adhocearning and adhoc_entry.adhocearning.component_name == component_name %}
														{{ adhoc_entry.amount }}
														{% elif adhoc_entry.adhocdeduction and adhoc_entry.adhocdeduction.component_name == component_name %}
														{{ adhoc_entry.amount }}
														{% endif %}
														{% endfor %}
													</td>
													{% endif %}
													{% endfor %}
							
							
													{% endfor %}
													<td style="text-align: right;">
														{% for payregdata in payreg_data %}
														{% if payregdata.user_id.id == i.id %}
														{{ payregdata.netpay }}
														{% endif %}
														{% endfor %}
													</td>
							
													<td>
														{% for user_id, statuses in user_statuses.items %}
														{% if user_id == i.id %}
														{% for status in statuses %}
														{{ status }}
														{% endfor %}
														{% endif %}
														{% endfor %}
							
													</td>
							
												</tr>
												{% endfor %}
											</tbody>
											</tr>
											{% for salaryhold in salary_hold %}
											{% if salaryhold.user_id.id == i.id %}
											{{salaryhold.actiontype}}
											{% endif %}
											{% endfor %}
											{% if not salary_hold %}
											{% endif %}
										</table>
															
									
								</form>
							</div>
			
								</div>
	</div>

	<div class="modal fade bs-example-modal-md" id="revert" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
		<div class="modal-dialog modal-dialog-centered modal-md">
			<div class="modal-content">
				
				<div class="modal-header">
					<h4 class="modal-title" >Revert Payroll Confirmation</h4>
					<button type="button" class="close" data-dismiss="modal">&times;</button>
							
				</div>
				<div class="modal-body">
					<div class="row">

						<div class="col-md-12">
							<p>This action will cancel the payroll run activity of this month including any 
								payslips that have been generated. Are you sure you want to revert payroll?</p>
						</div>

					</div>

				</div>
					<div class="modal-footer">
						<input type="button" class="btn btn-primary" value="Yes" href="" onclick="setActionType('revert')"> </input>
						<button type="button" class="btn btn-secondary" data-dismiss="modal">No</button>
					</div>
																			
			</div>
		</div>
	</div>

	   <div class="modal fade bs-example-modal-md" id="calculate" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
		<div class="modal-dialog modal-dialog-centered modal-md">
			<div class="modal-content">
				
				<div class="modal-header">
					<h4 class="modal-title" >Calculate Confirmation</h4>
					<button type="button" class="close" data-dismiss="modal">&times;</button>
							
				</div>
				<div class="modal-body">
					<div class="row">

						<div class="col-md-12">
							<p>Please confirm that you have changed the payroll data and want to calculate payroll data before continuing.</p>
						</div>

					</div>

				</div>
					<div class="modal-footer">
						<input type="button" class="btn btn-primary" value="Yes" href="" onclick="setActionType('calculate')"> </input>
						<button type="button" class="btn btn-secondary" data-dismiss="modal">No</button>
					</div>
																			
			</div>
		</div>
		</div>

		<div class="modal fade bs-example-modal-md" id="rupayroll" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
			<div class="modal-dialog modal-dialog-centered modal-md">
				<div class="modal-content">
					
					<div class="modal-header">
						<h4 class="modal-title" >Run Payroll Confirmation</h4>
						<button type="button" class="close" data-dismiss="modal">&times;</button>
								
					</div>
					<div class="modal-body">
						<div class="row">

							<div class="col-md-12">
								<p>
									Please confirm that you have verified the Payroll data from Pay Register before continuing.
								</p>
							</div>

						</div>

					</div>
						<div class="modal-footer">
							<input type="button" class="btn btn-primary" value="Yes" href="" onclick="setActionType('rupayroll')"> </input>
							<button type="button" class="btn btn-secondary" data-dismiss="modal">No</button>
						</div>
																				
				</div>
			</div>
		</div>

		<div class="modal fade bs-example-modal-md" id="genpayslip" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
			<div class="modal-dialog modal-dialog-centered modal-md">
				<div class="modal-content">
					
					<div class="modal-header">
						<h4 class="modal-title" >Confirm Your Action</h4>
						<button type="button" class="close" data-dismiss="modal">&times;</button>
								
					</div>
					<div class="modal-body">
						<div class="row">

							<div class="col-md-12">
								<p>
									This action will generate payslips for the selected employees and 
									send Email/SMS notifications to them. Are you sure you want to continue?
								</p>
							</div>

						</div>

					</div>
						<div class="modal-footer">
							<input type="button" class="btn btn-primary" value="Yes" href="" onclick="setActionType('payslip')"> </input>
							<button type="button" class="btn btn-secondary" data-dismiss="modal">No</button>
						</div>
																				
				</div>
			</div>
		</div>

		<!-- <div class="modal fade bs-example-modal-md" id="pay" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
			<div class="modal-dialog modal-dialog-centered modal-md">
				<div class="modal-content">
					
					<div class="modal-header">
						<h4 class="modal-title" >Pay Confirmation</h4>
						<button type="button" class="close" data-dismiss="modal">&times;</button>
								
					</div>
					<div class="modal-body">
						<div class="row">

							<div class="col-md-12">
								<p>
									This action will indicate that the salary has been paid. Are you sure you want to continue?															</p>
							</div>

						</div>

					</div>
						<div class="modal-footer">
							<input type="button" class="btn btn-primary" value="Yes" href="" onclick="setActionType('pay')"> </input>
							<button type="button" class="btn btn-secondary" data-dismiss="modal">No</button>
						</div>
																				
				</div>
			</div>
		</div> -->

		<div class="modal fade bs-example-modal-md" id="hold" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
			<div class="modal-dialog modal-dialog-centered modal-md">
				<div class="modal-content">
					
					<div class="modal-header">
						<h4 class="modal-title" >On Hold Confirmation</h4>
						<button type="button" class="close" data-dismiss="modal">&times;</button>
								
					</div>
					<div class="modal-body">
						<div class="row">

							<div class="col-md-12">
								<p>
									This action will indicate that the salary is currently on hold. Are you sure you want to continue?														
								</p>
							</div>

						</div>

					</div>
						<div class="modal-footer">
							<input type="button" class="btn btn-primary" value="Yes" href="" onclick="setActionType('hold')"> </input>
							<button type="button" class="btn btn-secondary" data-dismiss="modal">No</button>
						</div>
																				
				</div>
			</div>
		</div>


	<div class="modal fade bs-example-modal-md" id="downloadexcel" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
		<div class="modal-dialog modal-dialog-centered modal-md">
			<div class="modal-content">
				
				<div class="modal-body">
					
						<div>
							<i class="icon-copy fa fa-check-circle" aria-hidden="true" style="color: green; font-size: 90px; margin-left: 45%;"></i>
						</div>
						<div style="margin-left: 15%;">
						<b>Your request for export have been queued</b>
						</div>
						<div style="margin-left: 10%; justify-content: center;">
							As soon as the export process is complete, you will receive an email with the download link. 
							You may also view the status of your request by clicking File Manager
						</div>
				</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
						<a href="{% url 'filemanagernav' %}"  type="button" class="btn btn-primary btn-sm ">File Manager</a>
					</div>
																			
			
				</div>
		</div>
	</div>
				
	<!-- js -->
	<script src="/static/index/vendors/scripts/core.js"></script>
	<script src="/static/index/vendors/scripts/script.min.js"></script>
	<script src="/static/index/vendors/scripts/process.js"></script>
	<script src="/static/index/vendors/scripts/layout-settings.js"></script>
	<script src="/static/index/src/plugins/apexcharts/apexcharts.min.js"></script>
	<script src="/static/index/src/plugins/datatables/js/jquery.dataTables.min.js"></script>
	<script src="/static/index/src/plugins/datatables/js/dataTables.bootstrap4.min.js"></script>
	<script src="/static/index/src/plugins/datatables/js/dataTables.responsive.min.js"></script>
	<script src="/static/index/src/plugins/datatables/js/responsive.bootstrap4.min.js"></script>
	<script src="/static/index/vendors/scripts/dashboard.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels"></script>
	
	<script>
		new DataTable("#data_Table", {
				paging: true,
				scrollX: false,
				scrollY: 350,
				ordering: false,
				searching: true,
				pageLength: 50
			})
	</script>
	<script>
		$(document).ready(function () {
			// Function to get URL parameter value by name
			function getUrlParameter(name) {
				name = name.replace(/[\[]/, '\\[').replace(/[\]]/, '\\]');
				var regex = new RegExp('[\\?&]' + name + '=([^&#]*)');
				var results = regex.exec(location.search);
				return results === null ? '' : decodeURIComponent(results[1].replace(/\+/g, ' '));
			}

			// Initialize a variable to store the selected date
			var urlSelectedDate = getUrlParameter('monthselect');
			var selectedDate = urlSelectedDate || new Date().toLocaleDateString('en-US', { month: 'long', year: 'numeric' });
			var localStorageSelectedDate = localStorage.getItem("monthselect");

			// Initialize datepicker
			$("#monthPicker").datepicker({
				dateFormat: 'MM yyyy',
				defaultDate: urlSelectedDate, // Set the default date from the URL parameter

				onSelect: function (date) {
					// Update the selectedDate variable and the input field value

					selectedDate = date;
					localStorage.setItem("monthselect", selectedDate)
					// Submit the form when the date is selected
					$("#search-form").submit();

				}
			});

			if (localStorageSelectedDate) {
				$("#monthPicker").val(localStorageSelectedDate);
				if ($("#monthPicker").val() !== selectedDate) {
					$("#search-form").submit();
				}
			}
			else {
				$("#monthPicker").val(selectedDate);
			}

		});
	</script>

<script>
	$(document).ready(function () {
		// Delegate event for select-all checkbox
		$(document).on('click', '#select-all-checkbox', function () {
			$('.employee-checkbox').prop('checked', this.checked);
			countSelectedEmployees();
			updateCountColor();
		});

		// Delegate event for individual employee checkboxes
		$(document).on('click', '.employee-checkbox', function () {
			if ($('.employee-checkbox:checked').length === $('.employee-checkbox').length) {
				$('#select-all-checkbox').prop('checked', true);
			} else {
				$('#select-all-checkbox').prop('checked', false);
			}
			countSelectedEmployees();
			updateCountColor();
		});

		function countSelectedEmployees() {
			var count = $('.employee-checkbox:checked').length;
			$('#selected-employees-count').text(count);
		}

		function updateCountColor() {
			var count = $('.employee-checkbox:checked').length;
			var countElement = $('.count');
			const submitButton = document.querySelector('input[type="submit"]');
			console.log('submitButton: ', submitButton, count);
			if (count > 0) {
				countElement.css('background-color', 'blue');
				countElement.css('color', 'white');
				submitButton.disabled = false;
			} else {
				countElement.css('background-color', '#e4e4e4');
				countElement.css('color', 'black');
			}
		}
	});
</script>

<script>
    function setActionType(action) {
        document.getElementById('actionType').value = action;
		console.log('Log data: ', action);
        if (action === 'revert' || action === 'calculate' || action === 'rupayroll'  || action === 'payslip') {
            document.getElementById('FormId').action = "{% url 'payregister_statuschange' %}?monthselect={{ month_str }}+{{ selected_year }}";
        } else if (action === 'download') {
            document.getElementById('FormId').action = "{% url 'download_payregister' %}?monthselect={{ month_str }}+{{ selected_year }}";
        }
        document.getElementById('FormId').submit();
    }
</script>
	

</body>

</html> 
