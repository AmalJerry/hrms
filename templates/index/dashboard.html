<!DOCTYPE html>
<html>
{% load static %}

<head>
	<!-- Basic Page Info -->
	<meta charset="utf-8">

	<title>HRMS</title>

	<link rel="icon" href="/static/logo/apple-touch-icon.png" type="image/x-icon">

	<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
	<!-- sidebar icon -->
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">

	<!-- <link rel="shortcut icon" type="image/png" href=".../static/index/src/images/cydezlogo.png"> -->

	<!-- Site favicon -->
	<!-- <link rel="apple-touch-icon" sizes="180x180" href="/static/index/vendors/images/apple-touch-icon.png"> -->


	<!-- Mobile Specific Metas -->
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<!-- Google Font -->
	<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
		rel="stylesheet">
	<!-- CSS -->
	<link rel="stylesheet" type="text/css" href="/static/index/vendors/styles/core.css">
	<link rel="stylesheet" type="text/css" href="/static/index/vendors/styles/icon-font.min.css">
	<link rel="stylesheet" type="text/css"
		href="/static/index/src/plugins/datatables/css/dataTables.bootstrap4.min.css">
	<link rel="stylesheet" type="text/css"
		href="/static/index/src/plugins/datatables/css/responsive.bootstrap4.min.css">
	<link rel="stylesheet" type="text/css" href="/static/index/vendors/styles/style.css">
	<!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script> -->
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	<!-- Global site tag (gtag.js) - Google Analytics -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=UA-119386393-1"></script>
	<style>
		body {
			background: #f2f2f2;
		}

		.search-bt:hover {
			background-color: #1200ab !important;
		}

		#search-result {
			position: absolute;
			border: 1px solid #ddd;
			max-height: 200px;
			overflow-y: scroll;
			display: none;
			background-color: #f9f9f9;
		}

		.search-data {
			padding: 0 16px;
			margin: 5px 0;
		}

		.search-data:hover {
			background-color: #e4e1e1;
		}

		#no-notification-message {
			display: none;
			text-align: center;
			font-size: 18px;
			margin-top: 20px;
			/* Adjust this value for desired spacing from the notifications */
		}

		#notification-container {
			display: flex;
			/* flex-direction: column;
				align-items: center; */
			justify-content: center;

		}

		#no-notification-message {
			text-align: center;
			/* font-size: 18px; */
		}

		.revert-button {
			background: #0093ff;
			color: white;
			font-family: Arial, Helvetica, sans-serif;
			padding: 5px;
			border: 0;
			width: 150px;
			font-weight: 600;
			box-shadow: -1px 0px 3px 0px gray;
			transition-duration: 0.4s;
		}

		.revert-button:hover {
			background-color: orange;
		}

		/* @property --p {
			syntax: '<number>';
			inherits: true;
			initial-value: 0;
		} */

		.pie {
			--p: 20;
			--b: 22px;
			--c: darkred;
			--w: 150px;

			width: var(--w);
			aspect-ratio: 1;
			position: relative;
			display: inline-grid;
			margin: 5px;
			place-content: center;
			font-size: 25px;
			font-weight: bold;
			font-family: sans-serif;
			border: 2px solid var(--border-color);
		}

		.pie:before,
		.pie:after {
			content: "";
			position: absolute;
			border-radius: 50%;
		}

		.pie:before {
			inset: 0;
			background:
				radial-gradient(farthest-side, var(--c) 98%, #0000) top/var(--b) var(--b) no-repeat,
				conic-gradient(var(--c) calc(var(--p)*1%), #0000 0);
			-webkit-mask: radial-gradient(farthest-side, #0000 calc(99% - var(--b)), #000 calc(100% - var(--b)));
			mask: radial-gradient(farthest-side, #0000 calc(99% - var(--b)), #000 calc(100% - var(--b)));
		}

		.pie:after {
			inset: calc(50% - var(--b)/2);
			background: var(--c);
			transform: rotate(calc(var(--p)*3.6deg)) translateY(calc(50% - var(--w)/2));
		}

		.animate {
			animation: p 1s .5s both;
		}

		.no-round:before {
			background-size: 0 0, auto;
		}

		.no-round:after {
			content: none;
		}

		@keyframes p {
			from {
				--p: 0
			}
		}
	</style>

	<style>
		.flex-wrapper {
			display: flex;
			flex-flow: row nowrap;
		}

		.single-chart {
			width: 33%;
			justify-content: space-around;
		}

		.circular-chart {
			display: block;
			margin: 10px auto;
			max-width: 80%;
			max-height: 250px;
		}

		.circle-bg {
			fill: none;
			stroke: #eee;
			stroke-width: 3.8;
		}

		.circle {
			fill: none;
			stroke-width: 2.8;
			stroke-linecap: round;
			animation: progress 1s ease-out forwards;
		}

		@keyframes progress {
			0% {
				stroke-dasharray: 0 100;
			}
		}

		.circular-chart.orange .circle {
			stroke: #ff9f00;
		}

		.circular-chart.green .circle {
			stroke: #4CC790;
		}

		.circular-chart.blue .circle {
			stroke: #3c9ee5;
		}

		.circular-chart.red .circle {
			stroke: #dc3545
		}

		.percentage {
			fill: #666;
			font-family: sans-serif;
			font-size: 0.5em;
			text-anchor: middle;
		}
	</style>


</head>

<body>

	<div class="header">
		<div class="header-left">
			<div class="menu-icon dw dw-menu"></div>

			<div class="search-toggle-icon dw dw-search2" data-toggle="header_search"></div>
			<div class="header-search">
				<div class="form-group mb-0">
					<!-- <div class="dropdown"> -->
					<!-- <button type="text" onclick="myFunction()" class="dropbt   "></button> -->
					<!-- <div id="myDropdown" class="dropdown"> -->
					<!-- <input type="text" class="fa fa-search" onclick="" style="width: 350px;" class="inpt" placeholder="Search" name="search" id="myInput" onkeydown="closedrp()" onkeyup="filterFunction(),showdrp()" > -->
					<!-- style="padding-left: 20px; margin-top: 15px;" -->
					<i class="dw dw-search2 search-icon"></i>

					<!-- style=" border-radius: 2%;width: 450px;" -->
					<input type="text" class="form-control search-input" placeholder="Impersonate Employee"
						id="search-input" />
					<!-- onkeyup="filterFunction(),showdrp()" -->
					<div id="search-result">
						<ul>
							<li></li>
						</ul>
					</div>
					<div class="dropdown" id="myDropdown">
						<!-- style="margin-right: 600px;margin-top: 11px;height: 48px;" -->
						<button class=" btn-primary dropdown-toggle no-arrow search-bt" role="button" value="Search">
							<i class="ion-search" style="color:White"></i>
						</button>
						<!-- </div> -->
						<!-- dropdown-content style="display: none;"-->
						<div class="dropdown-menu dropdown-menu-right" style="width: 50%; padding: 0%;" id="drpdwn">
							<div class="col-sm-12 col-md-12" style="padding: 0%;">
								<div class="form-group" style="padding: 0%;">
									<!-- {% for i in datas %}
									 {# <a class="dropdown-item"  onclick="showform()" id="fn" href="{% url 'admin_view_employee' i.id  %}"> #}
	 								{{i.username}}</a>
								{% endfor %} -->
								</div>
							</div>
						</div>
					</div>
					<script>
						function showform() {
							document.getElementById('form').style.display = 'block';
						}
						function closedrp() {
							document.getElementById('drpdwn').style.display = 'none';
						}
						function showdrp() {
							document.getElementById('drpdwn').style.display = 'block';
						}
						function closeform() {
							document.getElementById('form').style.display = 'none';
						}
						document.getElementById('id').addEventListener('click', function (event) {
							event.preventDefault
						})
					</script>
					<!-- <button class="dw dw-search2 search-icon" onclick="showform()" style="margin-left: 343px;background-color: #2d1bd7;border-color: #2d1bd7; width: 52px; height: 41px;margin-top:15px;border-top-right-radius: 5px;border-bottom-right-radius: 5px;"> -->
				</div>
			</div>
		</div>

		<div class="header-right">

			<!-- <div class="dashboard-setting"> -->
			{% include 'messages.html' %}
			<!-- For Toast Message-->
			{% if button_flag %}

			<div style="display:flex;justify-content:center;flex-direction: row; flex-wrap: wrap;align-items: baseline;">

				{% if clock_in_type %}
				<div style="display:flex;justify-content:center;flex-direction: row; flex-wrap: wrap;align-items: baseline;">
					{% if clock_in_type == 2 %}
					<form action="{% url 'clock_in_out' %}" method="post" id="clock_form" style="margin-top: 1.2rem">
						{% csrf_token %}
						<input name="clock_in_type" type="hidden" value="1" id="clock_type_value" />
						<!-- <button class="btn btn-primary" type="submit" onclick="return submitForm(this)">
							Clock In
						</button> -->
						<!-- <a href="#" data-toggle="modal" data-target="#Medium-modal" type="button" class="btn btn-primary btn-sm scroll-click">
							Clock In
							</a> -->
					</form>
					{% else %}
					<form action="{% url 'clock_in_out' %}" method="post" id="clock_form" style="margin-top: 0.2rem">
						{% csrf_token %}
						<input name="clock_out_type" type="hidden" value="2" id="clock_type_value" />
						<!-- <button class="btn btn-danger" type="submit" onclick="return submitForm(this)">
							<div style="display: flex; justify-content: center; align-items: center;flex-direction: column;">
								<span>Clock Out</span>
								<span id="timer-id">00:00:00</span>
							</div>
						</button> -->
					</form>
					{% endif %}
				</div>
				{% endif %}
			</div>
			{% endif %}
			<!-- </div> -->

			<div class="user-notification">
				<div class="dropdown">
					<a class="dropdown-toggle no-arrow position-relative" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display: flex; align-items: center; padding: 1px 80px;">
						<span class="position-relative" style="display: inline-block;">
							<i class="icon-copy dw dw-notification" style="font-size: 1.5rem; color: #025680;"></i>
							{% if unread_count > 0 %}
								<span id="notification-badge"
									  style="
										  position: absolute;
										  top: -5px;
										  right: -50px;
										  min-width: 30px;
										  height: 35px;
										  background: #dc3545;
										  color: #fff;
										  border-radius: 50%;
										  padding: 8px;
										  display: flex;
										  align-items: center;
										  justify-content: center;
										  font-size: 0.75rem;
										  font-weight: 600;
										  box-shadow: 0 0 0 2px #fff;
										  border: 2px solid #fff;
									  ">
									{{ unread_count }}
								</span>
							{% endif %}
						</span>
						<span class="ml-2" style="font-weight: 500; color: #333; font-size: 1rem;"> </span>
					</a>
					<div class="dropdown-menu dropdown-menu-right">
						<div class="notification-list mx-h-350 customscroll">
							<ul class="notification-list mx-h-350 customscroll">

								{% for notification in notifications reversed %}
								{% if notification.readadmin == 0 %}
								<li class="notification" data-notification-id="{{ notification.notification_id }}">
									<a href="#" onclick="handleNotificationClick('{{ notification.notification_id }}')">
										<img src="{{ notification.image_url }}" alt="">
										{% if notification.user.id == request.user.id and notification.admin_id == 0 and notification.events == False %}
										<span style="color: black;">Leave request has been created</span>
										{% elif notification.user.id == request.user.id and notification.admin_id == 0 and notification.events == 1 %}
                          				<span style="color: black;">Your birthday is coming up in 15 days</span>
										{% elif notification.user.id == request.user.id and notification.admin_id == 0 and notification.events == 2 %}
										<span style="color: black;">Your work anniversary is coming up in 15 days.</span>
										{% elif notification.admin_id == request.user.id and notification.user.id == request.user.id and notification.is_approved == True %}
										<span style="color: black;">Leave request has been approved</span>
										{% elif notification.admin_id == request.user.id and notification.user.id == request.user.id and notification.is_approved == False and notification.events == False %}
										<span style="color: black;">Leave request has been rejected</span>
										{% else %}
										<span style="color: black;">{{ notification.message }}</span>
										{% endif %}
									</a>
								</li>
								{% endif %}
								{% endfor %}
							</ul>
							<div id="notification-container">
								<p id="no-notification-message" style="display: none;">No new notifications</p>
							</div>

							<div id="notification-container">
								<a href="{% url 'notification' %}" type="button" class="btn btn-primary btn-sm "
									style="width: 60%;">See All Notifications</a>
							</div>
						</div>
					</div>
				</div>
			</div>

			<script>
				function handleNotificationClick(notificationId) {
					// Remove the notification element with the matching notificationId
					const notificationElement = document.querySelector(`.notification[data-notification-id='${notificationId}']`);
					if (notificationElement) {
						notificationElement.remove();

						// Store the notification ID in localStorage to remember it's been clicked
						const clickedNotifications = JSON.parse(localStorage.getItem('clickedNotifications')) || [];
						clickedNotifications.push(notificationId);
						localStorage.setItem('clickedNotifications', JSON.stringify(clickedNotifications));

						// Check if there are any notifications left
						const notificationContainer = document.querySelector('.notification-list');
						if (!notificationContainer.querySelector('.notification')) {
							// If no notifications, display the message
							const noNotificationMessage = document.getElementById('no-notification-message');
							if (noNotificationMessage) {
								noNotificationMessage.style.display = 'block';
							}
						}
					}

					// Redirect to the 'notification' URL
					window.location.href = "{% url 'notification' %}";
				}

				document.addEventListener('DOMContentLoaded', function () {
					const clickedNotifications = JSON.parse(localStorage.getItem('clickedNotifications')) || [];
					clickedNotifications.forEach(notificationId => {
						const notificationElement = document.querySelector(`.notification[data-notification-id='${notificationId}']`);
						if (notificationElement) {
							notificationElement.remove();
						}
					});

					// Check if there are any notifications left and display the 'No new notifications' message
					const notificationContainer = document.querySelector('.notification-list');
					const red_color_dot = document.querySelector('.notification-active');
					if (!notificationContainer.querySelector('.notification')) {
						const noNotificationMessage = document.getElementById('no-notification-message');
						if (noNotificationMessage) {
							noNotificationMessage.style.display = 'block';
							red_color_dot.remove();
						}
					}
				});
			</script>


			<!-- <br> style="margin-left: 25px;" -->
			<div class="user-info-dropdown">
				<div class="dropdown">
	<a class="dropdown-toggle" href="#" role="button" data-toggle="dropdown">
		<span class="user-icon">
			{% if my_profile and my_profile.image %}
				<img src="{{ my_profile.image.url }}" alt="Dp" style="width: 100%; height: 100%;">
			{% else %}
				<img src="{% static 'logo/userlogo.png' %}" alt="Dp" style="width: 100%; height: 100%;">
			{% endif %}
		</span>
		<span class="user-name">{{ request.user.username }}</span>
	</a>
	<div class="dropdown-menu dropdown-menu-right dropdown-menu-icon-list">
		<a class="dropdown-item" href="{% url 'createpersonalinfo' %}"><i class="dw dw-user1"></i> Profile</a>
		<a class="dropdown-item" href="{% url 'department' %}" data-toggle="right-sidebar"><i class="dw dw-settings2"></i> Settings</a>
		<a class="dropdown-item" href="{% url 'help_page' %}"><i class="dw dw-help"></i> Help</a>
		<a class="dropdown-item" href="{% url 'logout' %}"><i class="dw dw-logout"></i> Logout</a>
	</div>
</div>

			</div>

		</div>
	</div>

	<div class="left-side-bar">
		<div class="brand-logo mt-3">
			<a href="{% url 'dashboard' %}">
				{% if request.user.company_type and request.user.company_type.inverse_logo %}
					<img src="{{ request.user.company_type.inverse_logo.url }}" alt="company logo" style="width: 100%; height: 100%;">
				{% else %}
					<img src="/static/logo/deskapp-logo-white.svg" alt="deskapp logo" class="light-logo">
				{% endif %}
			</a>
			<div class="close-sidebar" data-toggle="left-sidebar-close">
				<i class="ion-close-round"></i>
			</div>
		</div>
	<!-- <div class="brand-logo mt-3">
			<a href="{% url 'dashboard' %}">
				{% if request.user.company_type %}
				{% if request.user.company_type.inverse_logo %}
				<img src="{{ request.user.company_type.inverse_logo.url }}" style="width: 100%; height: 100%;">
				{% else %}
				<img src="/static/logo/deskapp-logo-white.svg" alt="" class="light-logo">
				{% endif %}
				{% else %}
				<img src="/static/logo/deskapp-logo-white.svg" alt="" class="light-logo">
				{% endif %}
			</a>
			<div class="close-sidebar" data-toggle="left-sidebar-close">
				<i class="ion-close-round"></i>
			</div>
		</div> -->
		

		<div class="menu-block customscroll">

			<div class="sidebar-menu">

				<ul id="accordion-menu">
					
					<br>
					<li class="btn-primary active" style="background-color:black">
						<a href="{% url 'dashboard' %}" class="dropdown-toggle no-arrow">
							<span class="micon dw dw-house-1"></span><span class="mtext"><b>Dashboard</b></span>
						</a>
					</li>
					
					<li>
						<a href="{% url 'companyprofile' %}" class="dropdown-toggle no-arrow">
							<span class="micon dw dw-building"></span><span class="mtext"><b>Company Profile</b></span>
						</a>
					</li>
					<li>
						<a href="{% url 'personalinfonav' %}" class="dropdown-toggle no-arrow">
							<span class="micon dw dw-user1"></span><span class="mtext"><b>My Profile</b></span>
						</a>
					</li>
					<li>
						<a href="{% url 'leave' %}" class="dropdown-toggle no-arrow">
							<span class="micon dw dw-calendar-1"></span><span class="mtext"><b>Leave</b></span>
						</a>
					</li>
					<li>
						<a href="{% url 'directory' %}" class="dropdown-toggle no-arrow">
							<span class="micon dw dw-list"></span><span class="mtext"><b>Directory</b></span>
						</a>
					</li>
					<li>
						<a href="{% url 'dailylog' %}" class="dropdown-toggle no-arrow">
							<span class="micon bi bi-check2-square"></span><span class="mtext"><b>Attendance</b></span>
						</a>
					</li>
					<li>
						<a href="{% url 'calender' %}" class="dropdown-toggle no-arrow">
							<span class="micon dw dw-calendar"></span><span class="mtext"><b>Holiday Calendar</b></span>
						</a>
					</li>
					<li>
						<a href="{% url 'runpayroll_overview' %}" class="dropdown-toggle no-arrow">
							<span class="micon dw dw-money-2"></span><span class="mtext"><b>Payroll</b></span>
						</a>
					</li>


				</ul>

			</div>
		</div>
	</div>

	<div class="dropdown">
		<button class=" btn-primary dropdown-toggle no-arrow search-bt" role="button" value="Search">
			<i class="fa fa-search" style="color:White"></i></button>
	</div>
	
	<div class="mobile-menu-overlay"></div>


	<div class="main-container" style="padding-top: 20px;">

		<div class="modal fade bs-example-modal-md" id="Medium-modal" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
			<div class="modal-dialog modal-md modal-dialog-centered">
				<form action="{% url 'clock_in_out' %}" method="post" id="modal_clock_form" onsubmit="return validateForm()">
					{% csrf_token %}
					<input name="clock_in_type" type="hidden" value="1" id="clock_type_value" />

				<div class="modal-content" id="dasboard-pop" style="margin-top: -90%; margin-left: 65%;">
					<div class="modal-body">
							{% csrf_token %}
							<div class="col-md-12">
								<label for="">Are you sure you want to clock in?</label>
								<div class="d-flex">
									<div class="custom-radio">
										<input type="radio" name="location" value="WFH" required>
										<label>WFH</label>
										&nbsp;&nbsp;
										<input type="radio" name="location" value="WFO" required>
										<label>WFO</label>
									</div>
								</div>
							</div>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
						<input type="submit" class="btn btn-primary" value="OK" id="submit-btn">
					</div>
				</div>
			</form>
			</div>
		</div>


		<div class="">
			<div class="card-box pd-20 height-100-p mb-1">
				<div class="row align-items-center">
					<div class="col-md-4">
						<img src="/static/index/vendors/images/banner-img.png" alt="">
					</div>
					<div class="col-md-8">
						<br><br><br><br>
							<h4 class="font-20 weight-500 mb-10 text-capitalize">
								<div class="weight-600 font-30 text-blue">Welcome Back {{request.user.username}}!</div>
							</h4>
							<p class="font-18">
								Your Central Hub for Streamlined HR Management! As the administrator, you hold the key
								to optimizing workforce operations. Navigate effortlessly through our comprehensive
								suite of tools designed to enhance efficiency, ensure compliance, and gain valuable
								insights. Your role is pivotal in driving organizational success, and HRMS is here to
								empower you every step of the way. </p>
					</div>
				</div>
			</div>

			<div class="row">
					<div class="col-lg-3 col-md-6 col-sm-12 mb-30">
						<div class="card-box pd-20 pt-10">
							<h2 class="mb-30 h4">Easy Access Links</h2>
							<div class="browser-visits">
								<ul>
									<li class="d-flex flex-wrap align-items-center">
										<a href="{% url 'view_all_home_locations' %}" class="browser-name">WFH Locations</a>
										<a href="{% url 'view_all_home_locations' %}" style="color: inherit;">
											<div class="visit"><span class="badge badge-pill-xl badge-info">View</span></div>
										</a>
									</li>
									<li class="d-flex flex-wrap align-items-center">
										<a href="{% url 'view_branch_locations' %}" class="browser-name">Branch Locations</a>
										<a href="{% url 'view_branch_locations' %}" style="color: inherit;">
											<div class="visit"><span class="badge badge-pill-xl badge-info"> View </span></div>
										</a>
									</li>
									

									<li class="d-flex flex-wrap align-items-center">
										<a href="{% url 'list_employee_profiles' %}" class="browser-name">Assigned Employees</a>
										<a href="{% url 'list_employee_profiles' %}" style="color: inherit;">
											<div class="visit">
												<span class="badge badge-pill-xl badge-info">View</span>
											</div>
										</a>
									</li>


									<li class="d-flex flex-wrap align-items-center">
										<a href="{% url 'attendance_logs' %}" class="browser-name">Today Attendance Log</a>
										<a href="{% url 'attendance_logs' %}"><span class="badge badge-pill badge-warning" style="margin-right: 10px; margin-left: 10px;">{{punched_count}}% </span>
											<a href="{% url 'attendance_summary' %}">
												<span class="badge badge-pill badge-info"> {{ active_user_punched_count }}</span>
											</a>
									</li>	
									<li class="d-flex flex-wrap align-items-center">
										<a href="{% url 'directory' %}" class="browser-name">Active Employees</a>
										 <a href="{% url 'directory' %}" style="color: inherit;"><div class="visit"><span class="badge badge-pill badge-warning">{{total_active_users}}</span></div></a>
										<div class="visit">
											<span class="badge badge-pill badge-info" style="cursor: pointer;" data-toggle="modal" data-target="#genderBreakdownModal">
												{{ gender_ratio }}
											</span>
										</div>
									</li>
									<li class="d-flex flex-wrap align-items-center">
										<a href="{% url 'log' %}" class="browser-name">Pending Leaves Request</a>
										<a href="{% url 'log' %}" style="color: inherit;"><div class="visit"><span class="badge badge-pill badge-warning">{{pending_leavecount}}</span></div></a>
									</li>
									<li class="d-flex flex-wrap align-items-center">
										<a href="{% url 'calender' %}" class="browser-name">{{month}} Holiday</a>
										<a href="{% url 'calender' %}" style="color: inherit;"><div class="visit"><span class="badge badge-pill badge-warning">{{holiday_count}}</span></div></a>
									</li>
									<li class="d-flex flex-wrap align-items-center">
										<a href="{% url 'automationlog' %}" class="browser-name">Pending Penalty Request</a>
										<a href="{% url 'automationlog' %}" style="color: inherit;"><div class="visit"><span class="badge badge-pill badge-warning">{{punchrequest_count}}</span></div></a>
									</li>

									<li class="d-flex flex-wrap align-items-center position-relative upcoming-birthday-section" style="cursor: pointer;">
										<a href="{% url 'calender' %}" class="browser-name">Upcoming Birthdays</a>
										<a href="{% url 'calender' %}" style="color: inherit;"><div class="visit">
											<span class="badge badge-pill badge-warning">{{ upcoming_birthday_count }}</span></a>
										</div>
										<span class="upcoming-birthday-tooltip" style="display:none; position:absolute; top:-22px; left:0; background:#333; color:#fff; padding:2px 8px; border-radius:4px; font-size:12px; white-space:nowrap; z-index:10;">
											Upcoming Birthdays For Next 30 Days
										</span>
									</li>
									<script>
										document.addEventListener('DOMContentLoaded', function() {
											const section = document.querySelector('.upcoming-birthday-section');
											const tooltip = section.querySelector('.upcoming-birthday-tooltip');
											section.addEventListener('mouseenter', function() {
												tooltip.style.display = 'block';
											});
											section.addEventListener('mouseleave', function() {
												tooltip.style.display = 'none';
											});
										});
									</script>

									<li class="d-flex flex-wrap align-items-center position-relative upcoming-workann-section" style="cursor: pointer;">
										<a href="{% url 'calender' %}" class="browser-name">Work Anniversary</a>
										<a href="{% url 'calender' %}" style="color: inherit;"><div class="visit"><span class="badge badge-pill badge-warning">{{work_anniversary_count}}</span></div></a>
										<span class="upcoming-workann-tooltip" style="display:none; position:absolute; top:-22px; left:0; background:#333; color:#fff; padding:2px 8px; border-radius:4px; font-size:12px; white-space:nowrap; z-index:10;">
											Work Anniversaries For Next 30 Days
										</span>
									</li>
									<script>
									document.addEventListener('DOMContentLoaded', function() {
										const section = document.querySelector('.upcoming-workann-section');
										if (section) {
											const tooltip = section.querySelector('.upcoming-workann-tooltip');
											section.addEventListener('mouseenter', function() {
												tooltip.style.display = 'block';
											});
											section.addEventListener('mouseleave', function() {
												tooltip.style.display = 'none';
											});
										}
									});
									</script>
									

									<li class="d-flex flex-wrap align-items-center">
										<a href="{% url 'monthly-movements' %}" class="browser-name">Last Month Joined</a>
										<a href="{% url 'monthly-movements' %}"><div class="visit"><span class="badge badge-pill badge-warning">{{ last_month_joined }}</span></div></a>
									</li>
									<li class="d-flex flex-wrap align-items-center">
										<a href="{% url 'monthly-movements' %}" class="browser-name">This Month Joined</a>

										<a href="{% url 'monthly-movements' %}"><div class="visit"><span class="badge badge-pill badge-warning">{{ this_month_joined }}</span></div></a>
									</li>
									<li class="d-flex flex-wrap align-items-center">
										<a href="{% url 'monthly-movements' %}" class="browser-name">Last Month Resigned</a>
										<a href="{% url 'monthly-movements' %}"><div class="visit"><span class="badge badge-pill badge-warning">{{ last_month_resigned }}</span></div></a>
									</li>
									<li class="d-flex flex-wrap align-items-center">
										<a href="{% url 'monthly-movements' %}" class="browser-name">This Month Resigned</a>
										<a href="{% url 'monthly-movements' %}"><div class="visit"><span class="badge badge-pill badge-warning">{{ this_month_resigned }}</span></div></a>
									</li>
									
								</ul>
							</div>
						</div>
					</div>

			
				<div class="col-lg-9 col-md-6 col-sm-12 mb-10">
					<div class="card-box pd-10 pt-10">
						<div id="carouselExampleSlidesOnly" class="carousel slide" data-ride="carousel">
							<div class="carousel-inner">
								<!-- Work Anniversary Section - Simplified Logic -->
								{% if work_anniversaries %}
								<div class="carousel-item{% if not birthday_users %} active{% endif %}">
									<h2 class="h4">
										{% if work_anniversaries|length > 1 %}
											{% if request.user in work_anniversaries %}
												Congratulations {{ request.user.get_full_name|default:request.user.username }} on your work anniversary!
												Also celebrating: 
												{% for user in work_anniversaries %}
													{% if user != request.user %}
														{{ user.get_full_name|default:user.username }}{% if not forloop.last %}, {% endif %}
													{% endif %}
												{% endfor %}
											{% else %}
												{% for user in work_anniversaries %}
													{{ user.get_full_name|default:user.username }}{% if not forloop.last %}, {% endif %}
												{% endfor %}'s work anniversary today!
											{% endif %}
										{% else %}
											{% with user=work_anniversaries.0 %}
												{% if request.user.id == user.id %}
													Congratulations on your work anniversary!
												{% else %}
													{{ user.get_full_name|default:user.username }}'s work anniversary today!
												{% endif %}
											{% endwith %}
										{% endif %}
										<img class="d-block w-100" 
											src="{% static 'index/vendors/images/happy anniversary!.gif' %}" 
											alt="Work Anniversary">
									</h2>
								</div>
								{% endif %}

								<!-- Birthday Section -->
								{% if birthday_users %}
								<div class="carousel-item{% if not work_anniversaries %} active{% endif %}">
									<h2 class="h4">
										{% if birthday_users|length > 1 %}
											{% if request.user in birthday_users %}
												Happy Birthday to you
												{% for user in birthday_users %}
													{% if user != request.user %}
														and {{ user.get_full_name|default:user.username }}{% if not forloop.last %},{% endif %}
													{% endif %}
												{% endfor %}!
											{% else %}
												{% for user in birthday_users %}
													{{ user.get_full_name|default:user.username }}{% if not forloop.last %}, {% endif %}
												{% endfor %}'s birthday today!
											{% endif %}
										{% else %}
											{% for user in birthday_users %}
												{% if request.user.id == user.id %}
													Happy Birthday to you!
												{% else %}
													{{ user.get_full_name|default:user.username }}'s birthday today!
												{% endif %}
											{% endfor %}
										{% endif %}
										<img class="d-block w-100" 
											src="{% static 'index/vendors/images/Birthday (1).gif' %}" 
											alt="Birthday">
									</h2>
								</div>
								{% endif %}

								<!-- Default Section -->
								{% if not work_anniversaries and not birthday_users %}
								<div class="carousel-item active">
									<img class="d-block w-100" 
										src="{% static 'index/vendors/images/Have a great day at work!.gif' %}"
										alt="Have a great day">
								</div>
								{% endif %}
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- js -->
	<script src="/static/index/vendors/scripts/core.js"></script>
	<script src="/static/index/vendors/scripts/script.min.js"></script>
	<script src="/static/index/vendors/scripts/process.js"></script>
	<script src="/static/index/vendors/scripts/layout-settings.js"></script>
	<script src="/static/index/src/plugins/apexcharts/apexcharts.min.js"></script>
	<script src="/static/index/src/plugins/datatables/js/jquery.dataTables.min.js"></script>
	<script src="/static/index/src/plugins/datatables/js/dataTables.bootstrap4.min.js"></script>
	<script src="/static/index/src/plugins/datatables/js/dataTables.responsive.min.js"></script>
	<script src="/static/index/src/plugins/datatables/js/responsive.bootstrap4.min.js"></script>
	<script src="/static/index/vendors/scripts/dashboard.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels"></script>

	<script>
		// $(element).on('click', function (e) {
		// 	e.preventDefault();
		// });

		function myFunction() {
			document.getElementById("myDropdown").classList.toggle("show");
		}

		function filterFunction() {
			var input, filter, ul, li, a, i;
			input = document.getElementById("myInput");
			filter = input.value.toUpperCase();
			div = document.getElementById("myDropdown");
			a = div.getElementsByTagName("a");
			for (i = 0; i < a.length; i++) {
				txtValue = a[i].textContent || a[i].innerText;
				if (txtValue.toUpperCase().indexOf(filter) > -1) {
					a[i].style.display = "";
				} else {
					a[i].style.display = "none";
				}
			}
		}
	</script>
	
	<script>
		function fetchData(query) {
			fetch("/admin_employee_detials")
				.then((response) => response.json())
				.then((data) => {
					console.log(data)
					var searchResults = document.getElementById("search-result");
					searchResults.innerHTML = "";
					if (query.length > 0) {
						if (data.length === 0) {
							searchResults.innerHTML = "<p>No data found</p>";
						} else {
							var filteredData = data.filter(function (item) {
								return item.username
									.toLowerCase()
									.includes(query.toLowerCase());
							});
							if (filteredData.length === 0) {
								searchResults.innerHTML =
									"<div  class='form-control' style='display:block;'><ul><li id='search-item'>No matching data found</li></ul></div>";
							} else {
								filteredData.forEach(function (item) {
									searchResults.innerHTML +=
										`
										  <a href="/view_personalinfo${item.id}">
											<div class="col-md-12 search-data" style='height:2rem'>
											  <ul>
												<li id="search-item" class='' '> <!-- style='display:flex;justify-content:center;-->
												  <p style=>${item.username}</p>
												</li>
											  </ul>
											</div>
										  </a>
										  `;
									searchResults.style.display = 'block';
									searchResults.style.width = '100%'
									searchResults.style.alignItems = 'center'
									searchResults.style.alignContent = 'center'

								});
							}
						}
					}
				})
				.catch((err) => {
					var searchResults = document.getElementById("search-result");
					searchResults.innerHTML = "<p>No data found</p>";
				});
		}

		document.addEventListener("DOMContentLoaded", function () {
			var searchInput = document.getElementById("search-input");
			searchInput.addEventListener("input", function () {
				var query = searchInput.value.trim();
				fetchData(query);
			});
		});
	</script>

	<script>
		document.addEventListener("DOMContentLoaded", function () {
			var ctx = document.getElementById('chart').getContext('2d');
			var punchedCount = 40;
			var remainingCount = 100 - punchedCount;

			var data = {
				datasets: [{
					data: [punchedCount, remainingCount],
					backgroundColor: ['rgb(75, 192, 192)', 'rgb(255, 255, 255)'],
					borderColor: 'rgba(255, 255, 255, 0.9)',
					/* hoverBackgroundColor: ['rgba(0, 0, 0, 0)', 'rgba(0, 0, 0, 0)'], */
				}],
			};

			var options = {
				cutoutPercentage: 70,
				plugins: {
					datalabels: {
						display: true,
						color: 'white', // You can customize the color
						formatter: function (value, context) {
							return value; // Display the value on the chart
						}
					}
				},
				animation: {
					animateRotate: true,
					animateScale: true
				}
			};

			var myDoughnutChart = new Chart(ctx, {
				type: 'doughnut',
				data: data,
				options: options
			});
		});
	</script>

	<!-- <script>
		function submitForm(button) {
			var clock_type_value = button.form.querySelector("#clock_type_value").value;
			if (clock_type_value == 1 && !button.disabled) {
				if (confirm("Are you sure you want to clock in?")) {
					button.disabled = true; // Disable the button to prevent multiple submissions
					button.form.submit(); // Manually submit the form
					return true;
				} else {
					return false;
				}
			} else if (clock_type_value == 2 && !button.disabled) {
				if (confirm("Are you sure you want to clock out?")) {
					button.disabled = true; // Disable the button to prevent multiple submissions
					button.form.submit(); // Manually submit the form
					return true;
				} else {
					return false;
				}
			}
			return false; // Return false by default if conditions are not met
		}
	</script> -->

	<script>
		function submitForm(button) {
			var clock_type_value = button.form.querySelector("#clock_type_value").value;
			if (clock_type_value == 1 && !button.disabled) {
				$('#Medium-modal').modal('show'); 
				return false;
			} else if (clock_type_value == 2 && !button.disabled) {
				if (confirm("Are you sure you want to clock out?")) {
					button.disabled = true;
					button.form.submit();
					return true;
				} else {
					return false;
				}
			}
			return false;
		}
	
		// function validateForm() {
		// 	var selectedLocation = document.querySelector("input[name='location']:checked");
		// 	if (!selectedLocation) {
		// 		alert("Please select a location.");
		// 		return false; 
		// 	}
		// 	return true; 
		// }
	</script>
<script>
	function validateForm() {
		var selectedLocation = document.querySelector("input[name='location']:checked");
		if (!selectedLocation) {
			alert("Please select a location.");
			return false;
		}

		// Disable submit button after first click
		var submitButton = document.querySelector("input[type='submit']");
		submitButton.disabled = true;
		submitButton.value = "Requesintg...";

		return true;
	}
</script>

	<script>
		/* Duration */
		$(document).ready(function () {
			var $timer = $('#timer-id');
			var startTime = null;
			var intervalID = null;

			function updateDuration() {
				if (startTime === null) {
					return;
				}
				var currentTime = new Date();
				var duration = currentTime - startTime;

				var days = Math.floor(duration / (1000 * 60 * 60 * 24));
				duration -= days * (1000 * 60 * 60 * 24);
				var hours = Math.floor(duration / (1000 * 60 * 60));
				duration -= hours * (1000 * 60 * 60);
				var minutes = Math.floor(duration / (1000 * 60));
				duration -= minutes * (1000 * 60);
				var seconds = Math.floor(duration / 1000);

				var formattedTime = (days > 0 ? pad(days, 2) + ":" : "") + (hours >= 0 ? pad(hours, 2) + ":" : "") + (minutes >= 0 ? pad(minutes, 2) + ":" : "") + (seconds >= 0 ? pad(seconds, 2) : "");
				// console.log("Formatted time: ", formattedTime);
				$timer.text(formattedTime);
			}

			function fetchStartTime() {
				var start_time = "{{in_time|safe}}" || "00:00:00";
				startTime = new Date();
				startTime.setHours(0); 
				startTime.setMinutes(0);
				startTime.setSeconds(0);
				startTime.setMilliseconds(0);
				var startHours = parseInt(start_time.split(':')[0], 10);
				var startMinutes = parseInt(start_time.split(':')[1], 10);
				startTime.setHours(startHours);
				startTime.setMinutes(startMinutes);
				setInterval(updateDuration, 1000);
			}

			fetchStartTime();

			// Function to pad single digits with leading zeros
			function pad(number, length) {
				var str = '' + number;
				while (str.length < length) {
					str = '0' + str;
				}
				return str;
			}
		});

	</script>
	<script>
		document.getElementById('modal_clock_form').addEventListener('submit', function() {
		  const submitButton = document.getElementById('submit-btn');
		  submitButton.value = "Clocking In...";
		  submitButton.disabled = true; // Prevent multiple clicks
		});
		</script>
</body>
<!-- Gender Breakdown Modal -->
<div class="modal fade" id="genderBreakdownModal" tabindex="-1" role="dialog" aria-labelledby="genderModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
    <div class="modal-content border-info">
      <div class="modal-header bg-info text-white">
        <h5 class="modal-title" id="genderModalLabel">Gender Breakdown ({{ total_active_users }} Employees)</h5>
        <button type="button" class="close text-white" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <table class="table table-bordered table-hover text-center">
          <thead class="thead-light">
            <tr>
              <th>Gender</th>
              <th>Percentage</th>
              <th>Employees</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Male</td>
              <td>{{ male_percent }}%</td>
              <td>
				
					<div style="max-height: 150px; overflow-y: auto; text-align:left;">
					{% for user in male_users %}
						<a href="{% url 'view_personalinfo' user.id %}">• {{ user.username }}<br></a>
					{% endfor %}
					</div>
			
              </td>
            </tr>
            <tr>
              <td>Female</td>
              <td>{{ female_percent }}%</td>
              <td>
				
					<div style="max-height: 150px; overflow-y: auto; text-align:left;">
					{% for user in female_users %}
					<a href="{% url 'view_personalinfo' user.id %}">• {{ user.username }}<br></a>
					{% endfor %}
					</div>
			
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>



</html>